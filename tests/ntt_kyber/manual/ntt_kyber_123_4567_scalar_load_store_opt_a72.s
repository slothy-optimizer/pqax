///
/// Copyright (c) 2022 Arm Limited
/// Copyright (c) 2022 Hanno Becker
/// Copyright (c) 2023 Amin Abdulrahman, Matthias Kannwischer
/// SPDX-License-Identifier: MIT
///
/// Permission is hereby granted, free of charge, to any person obtaining a copy
/// of this software and associated documentation files (the "Software"), to deal
/// in the Software without restriction, including without limitation the rights
/// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
/// copies of the Software, and to permit persons to whom the Software is
/// furnished to do so, subject to the following conditions:
///
/// The above copyright notice and this permission notice shall be included in all
/// copies or substantial portions of the Software.
///
/// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
/// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
/// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
/// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
/// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
/// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
/// SOFTWARE.
///

// Needed to provide ASM_LOAD directive
#include <hal_env.h>

// NOTE
// We use a lot of trivial macros to simplify the parsing burden for Slothy
// The macros are not unfolded by Slothy and thus interpreted as instructions,
// which are easier to parse due to e.g. the lack of size specifiers and simpler
// syntax for pre and post increment for loads and stores.
//
// Eventually, NeLight should include a proper parser for AArch64,
// but for initial investigations, the below is enough.

xtmp0 .req x10
xtmp1 .req x11
.macro vins vec_out, gpr_in, lane
        ins \vec_out\().d[\lane], \gpr_in
.endm

.macro vext gpr_out, vec_in, lane
        umov \gpr_out\(), \vec_in\().d[\lane]
.endm

.macro ldr_vo vec, base, offset
        ldr xtmp0, [\base, #\offset]
        ldr xtmp1, [\base, #(\offset+8)]
        vins \vec, xtmp0, 0
        vins \vec, xtmp1, 1
.endm

.macro ldr_vi vec, base, inc
        ldr xtmp0, [\base], #\inc
        ldr xtmp1, [\base, #(-\inc+8)]
        vins \vec, xtmp0, 0
        vins \vec, xtmp1, 1
.endm

.macro str_vo vec, base, offset
        str qform_\vec, [\base, #\offset]
.endm
.macro str_vi vec, base, inc
        str qform_\vec, [\base], #\inc
.endm

.macro vqrdmulh d,a,b
        sqrdmulh \d\().8h, \a\().8h, \b\().8h
.endm
.macro vmlsq d,a,b,i
        mls \d\().8h, \a\().8h, \b\().h[\i]
.endm
.macro vqrdmulhq d,a,b,i
        sqrdmulh \d\().8h, \a\().8h, \b\().h[\i]
.endm
.macro vqdmulhq d,a,b,i
        sqdmulh \d\().8h, \a\().8h, \b\().h[\i]
.endm
.macro vmulq d,a,b,i
        mul \d\().8h, \a\().8h, \b\().h[\i]
.endm

.macro mulmodq dst, src, const, idx0, idx1
        vmulq       \dst,  \src, \const, \idx0
        vqrdmulhq   \src,  \src, \const, \idx1
        vmlsq        \dst,  \src, consts, 0
.endm

.macro mulmod dst, src, const, const_twisted
        mul        \dst\().8h,  \src\().8h, \const\().8h
        vqrdmulh   \src,  \src, \const_twisted
        vmlsq      \dst,  \src, consts, 0
.endm

.macro ct_butterfly a, b, root, idx0, idx1
        mulmodq  tmp, \b, \root, \idx0, \idx1
        sub     \b\().8h,    \a\().8h, tmp.8h
        add     \a\().8h,    \a\().8h, tmp.8h
.endm

.macro mulmod_v dst, src, const, const_twisted
        mul         \dst\().8h,  \src\().8h, \const\().8h
        vqrdmulh    \src,  \src, \const_twisted
        vmlsq       \dst,  \src, consts, 0
.endm

.macro ct_butterfly_v a, b, root, root_twisted
        mulmod  tmp, \b, \root, \root_twisted
        sub    \b\().8h,    \a\().8h, tmp.8h
        add    \a\().8h,    \a\().8h, tmp.8h
.endm

.macro barrett_reduce a
        vqdmulhq tmp, \a, consts, 1
        srshr    tmp.8h, tmp.8h, #11
        vmlsq    \a, tmp, consts, 0
.endm

.macro load_roots_123
        ldr_vi root0, r_ptr0, 32
        ldr_vo root1, r_ptr0, -16
.endm

.macro load_next_roots_45
        ldr_vi root0, r_ptr0, 16
.endm

.macro load_next_roots_67
        ldr_vi root0,    r_ptr1, (6*16)
        ldr_vo root0_tw, r_ptr1, (-6*16 + 1*16)
        ldr_vo root1,    r_ptr1, (-6*16 + 2*16)
        ldr_vo root1_tw, r_ptr1, (-6*16 + 3*16)
        ldr_vo root2,    r_ptr1, (-6*16 + 4*16)
        ldr_vo root2_tw, r_ptr1, (-6*16 + 5*16)
.endm

.macro transpose4 data
        trn1 t0.4s, \data\()0\().4s, \data\()1\().4s
        trn2 t1.4s, \data\()0\().4s, \data\()1\().4s
        trn1 t2.4s, \data\()2\().4s, \data\()3\().4s
        trn2 t3.4s, \data\()2\().4s, \data\()3\().4s

        trn2 \data\()2\().2d, t0.2d, t2.2d
        trn2 \data\()3\().2d, t1.2d, t3.2d
        trn1 \data\()0\().2d, t0.2d, t2.2d
        trn1 \data\()1\().2d, t1.2d, t3.2d
.endm

.macro transpose_single data_out, data_in
        trn1 \data_out\()0\().4s, \data_in\()0\().4s, \data_in\()1\().4s
        trn2 \data_out\()1\().4s, \data_in\()0\().4s, \data_in\()1\().4s
        trn1 \data_out\()2\().4s, \data_in\()2\().4s, \data_in\()3\().4s
        trn2 \data_out\()3\().4s, \data_in\()2\().4s, \data_in\()3\().4s
.endm

.macro vec_to_scalar_matrix out, in
        vext \out\()_00, \in\()0, 0
        vext \out\()_01, \in\()0, 1
        vext \out\()_10, \in\()1, 0
        vext \out\()_11, \in\()1, 1
        vext \out\()_20, \in\()2, 0
        vext \out\()_21, \in\()2, 1
        vext \out\()_30, \in\()3, 0
        vext \out\()_31, \in\()3, 1
.endm

.macro store_scalar_matrix_with_inc x, addr, inc
        str \x\()t_00, [\addr], #( \inc)
        str \x\()t_01, [\addr,  #(-\inc + 8*1)]
        str \x\()t_10, [\addr,  #(-\inc + 8*2)]
        str \x\()t_11, [\addr,  #(-\inc + 8*3)]
        str \x\()t_20, [\addr,  #(-\inc + 8*4)]
        str \x\()t_21, [\addr,  #(-\inc + 8*5)]
        str \x\()t_30, [\addr,  #(-\inc + 8*6)]
        str \x\()t_31, [\addr,  #(-\inc + 8*7)]
.endm


.macro save_gprs // slothy:no-unfold
        sub sp, sp, #(16*6)
        stp x19, x20, [sp, #16*0]
        stp x19, x20, [sp, #16*0]
        stp x21, x22, [sp, #16*1]
        stp x23, x24, [sp, #16*2]
        stp x25, x26, [sp, #16*3]
        stp x27, x28, [sp, #16*4]
        str x29, [sp, #16*5]
.endm

.macro restore_gprs // slothy:no-unfold
        ldp x19, x20, [sp, #16*0]
        ldp x21, x22, [sp, #16*1]
        ldp x23, x24, [sp, #16*2]
        ldp x25, x26, [sp, #16*3]
        ldp x27, x28, [sp, #16*4]
        ldr x29, [sp, #16*5]
        add sp, sp, #(16*6)
.endm

.macro save_vregs // slothy:no-unfold
        sub sp, sp, #(16*4)
        stp  d8,  d9, [sp, #16*0]
        stp d10, d11, [sp, #16*1]
        stp d12, d13, [sp, #16*2]
        stp d14, d15, [sp, #16*3]
.endm

.macro restore_vregs // slothy:no-unfold
        ldp  d8,  d9, [sp, #16*0]
        ldp d10, d11, [sp, #16*1]
        ldp d12, d13, [sp, #16*2]
        ldp d14, d15, [sp, #16*3]
        add sp, sp, #(16*4)
.endm

#define STACK_SIZE 16
#define STACK0 0

.macro restore a, loc     // slothy:no-unfold
        ldr \a, [sp, #\loc\()]
.endm
.macro save loc, a        // slothy:no-unfold
        str \a, [sp, #\loc\()]
.endm
.macro push_stack // slothy:no-unfold
        save_gprs
        save_vregs
        sub sp, sp, #STACK_SIZE
.endm

.macro pop_stack // slothy:no-unfold
        add sp, sp, #STACK_SIZE
        restore_vregs
        restore_gprs
.endm

.data
.p2align 4
roots:
#include "ntt_kyber_123_45_67_twiddles.s"
.text

        .global ntt_kyber_123_4567_scalar_load_store_opt_a72
        .global _ntt_kyber_123_4567_scalar_load_store_opt_a72

.p2align 4
const_addr:       .short 3329
                  .short 20159
                  .short 0
                  .short 0
                  .short 0
                  .short 0
                  .short 0
                  .short 0
ntt_kyber_123_4567_scalar_load_store_opt_a72:
_ntt_kyber_123_4567_scalar_load_store_opt_a72:
        push_stack

        in      .req x0
        inp     .req x1
        count   .req x2
        r_ptr0  .req x3
        r_ptr1  .req x4
        xtmp    .req x5

        qform_v0  .req q0
        qform_v1  .req q1
        qform_v2  .req q2
        qform_v3  .req q3
        qform_v4  .req q4
        qform_v5  .req q5
        qform_v6  .req q6
        qform_v7  .req q7
        qform_v8  .req q8
        qform_v9  .req q9
        qform_v10 .req q10
        qform_v11 .req q11
        qform_v12 .req q12
        qform_v13 .req q13
        qform_v14 .req q14
        qform_v15 .req q15
        qform_v16 .req q16
        qform_v17 .req q17
        qform_v18 .req q18
        qform_v19 .req q19
        qform_v20 .req q20
        qform_v21 .req q21
        qform_v22 .req q22
        qform_v23 .req q23
        qform_v24 .req q24
        qform_v25 .req q25
        qform_v26 .req q26
        qform_v27 .req q27
        qform_v28 .req q28
        qform_v29 .req q29
        qform_v30 .req q30
        qform_v31 .req q31

        data0  .req v8
        data1  .req v9
        data2  .req v10
        data3  .req v11
        data4  .req v12
        data5  .req v13
        data6  .req v14
        data7  .req v15

        x_00 .req x10
        x_01 .req x11
        x_10 .req x12
        x_11 .req x13
        x_20 .req x14
        x_21 .req x15
        x_30 .req x16
        x_31 .req x17

        xt_00 .req x_00
        xt_01 .req x_20
        xt_10 .req x_10
        xt_11 .req x_30
        xt_20 .req x_01
        xt_21 .req x_21
        xt_30 .req x_11
        xt_31 .req x_31

        qform_data0  .req q8
        qform_data1  .req q9
        qform_data2  .req q10
        qform_data3  .req q11
        qform_data4  .req q12
        qform_data5  .req q13
        qform_data6  .req q14
        qform_data7  .req q15

        root0    .req v0
        root1    .req v1
        root2    .req v2
        root0_tw .req v4
        root1_tw .req v5
        root2_tw .req v6

        consts         .req v7
        qform_consts   .req q7

        qform_root0    .req q0
        qform_root1    .req q1
        qform_root2    .req q2
        qform_root0_tw .req q4
        qform_root1_tw .req q5
        qform_root2_tw .req q6

        tmp .req v24
        t0  .req v25
        t1  .req v26
        t2  .req v27
        t3  .req v28

        ASM_LOAD(r_ptr0, roots)
        ASM_LOAD(r_ptr1, roots_l56)

        ASM_LOAD(xtmp, const_addr)
        ld1 {consts.8h}, [xtmp]

        save STACK0, in
        mov count, #4

        load_roots_123

        .p2align 2
        ldr x10, [x0, #384]                      // .*.....................
        ldr x20, [x0, #320]                      // ....*..................
        // gap                                   // .......................
        ldr x26, [x0, #8]                        // ......................*
        ldr x29, [x0, #192]                      // ..................*....
        // gap                                   // .......................
        ldr x18, [x0, #256]                      // .....*.................
        ldr x17, [x0, #264]                      // *......................
        // gap                                   // .......................
        ldr x24, [x0, #448]                      // ..*....................
        // gap                                   // .......................
        // gap                                   // .......................
        ins v14.d[0], x10                        // .......*...............
        ins v30.d[0], x20                        // ............*..........
        ldr x10, [x0, #328]                      // ...*...................
        ins v31.d[0], x29                        // .....................*.
        ldr x22, [x0, #392]                      // .........*.............
        // gap                                   // .......................
        ins v21.d[0], x18                        // ........*..............
        ldr x20, [x0, #456]                      // ...........*...........
        // gap                                   // .......................
        ins v16.d[0], x24                        // ......*................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        ins v30.d[1], x10                        // ................*......
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        ins v21.d[1], x17                        // ..........*............
        // gap                                   // .......................
        // gap                                   // .......................
        ins v16.d[1], x20                        // .............*.........
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        sqrdmulh v18.8H, v30.8H, v0.H[1]         // ....................*..
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        sqrdmulh v29.8H, v21.8H, v0.H[1]         // ..............*........
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        mul v20.8H, v21.8H, v0.H[0]              // ...............*.......
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        sqrdmulh v12.8H, v16.8H, v0.H[1]         // .................*.....
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        // gap                                   // .......................
        mls v20.8H, v29.8H, v7.H[0]              // ...................*...
        // gap                                   // .......................
        // gap                                   // .......................
        
        // original source code
        // ldr x8, [x0, #264]                    // .....*................. || ..*......................
        // ldr x17, [x0, #384]                   // *...................... || *........................
        // ldr x15, [x0, #448]                   // ......*................ || ...*.....................
        // ldr x23, [x0, #328]                   // .........*............. || ....*....................
        // ldr x29, [x0, #320]                   // .*..................... || *........................
        // ldr x20, [x0, #256]                   // ....*.................. || ..*......................
        // ins v16.d[0], x15                     // ..............*........ || .......*.................
        // ins v14.d[0], x17                     // .......*............... || ....*....................
        // ins v22.d[0], x20                     // ............*.......... || ......*..................
        // ldr x22, [x0, #392]                   // ...........*........... || .....*...................
        // ins v22.d[1], x8                      // ................*...... || ............*............
        // ldr x10, [x0, #456]                   // .............*......... || ......*..................
        // ins v30.d[0], x29                     // ........*.............. || ....*....................
        // ins v16.d[1], x10                     // .................*..... || .............*...........
        // sqrdmulh v19.8H, v22.8H, v0.H[1]      // ...................*... || ..................*......
        // mul v20.8H, v22.8H, v0.H[0]           // ....................*.. || ....................*....
        // ins v30.d[1], x23                     // ...............*....... || ..........*..............
        // sqrdmulh v12.8H, v16.8H, v0.H[1]      // .....................*. || ......................*..
        // ldr x10, [x0, #192]                   // ...*................... || .*.......................
        // mls v20.8H, v19.8H, v7.H[0]           // ......................* || ........................*
        // sqrdmulh v18.8H, v30.8H, v0.H[1]      // ..................*.... || ................*........
        // ins v31.d[0], x10                     // ..........*............ || .....*...................
        // ldr x26, [x0, #8]                     // ..*.................... || .*.......................
        
        sub count, count, #1
layer123_start:
        ins v14.d[1], x22                        // ...........................*........................................................................
        mul v3.8H, v30.8H, v0.H[0]               // .....................................*..............................................................
        ldr x8, [x0, #280]                       // .................e..................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        ldr x16, [x0, #200]                      // .............*......................................................................................
        ldr x17, [x0, #400]                      // ........................e...........................................................................
        mul v8.8H, v16.8H, v0.H[0]               // ...............................................*....................................................
        ldr x15, [x0, #464]                      // ............................e.......................................................................
        ldr x23, [x0, #344]                      // .....................e..............................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        ldr x29, [x0, #336]                      // ....................e...............................................................................
        mls v8.8H, v12.8H, v7.H[0]               // .................................................*..................................................
        // gap                                   // ....................................................................................................
        ldr x20, [x0, #272]                      // ................e...................................................................................
        ins v31.d[1], x16                        // ...............*....................................................................................
        // gap                                   // ....................................................................................................
        ins v16.d[0], x15                        // ..............................e.....................................................................
        sqrdmulh v24.8H, v14.8H, v0.H[1]         // ...........................................*........................................................
        ldr x19, [x0, #128]                      // ........*...........................................................................................
        ldr x21, [x0, #72]                       // .....*..............................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v13.8H, v14.8H, v0.H[0]              // ..........................................*.........................................................
        ins v14.d[0], x17                        // ..........................e.........................................................................
        ldr x14, [x0, #64]                       // ....*...............................................................................................
        ins v22.d[0], x20                        // ..................e.................................................................................
        // gap                                   // ....................................................................................................
        ldr x17, [x0, #0]                        // *...................................................................................................
        ins v6.d[0], x19                         // ..........*.........................................................................................
        mls v3.8H, v18.8H, v7.H[0]               // .......................................*............................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        add v2.8H, v31.8H, v8.8H                 // ...................................................*................................................
        ins v5.d[0], x14                         // ......*.............................................................................................
        mls v13.8H, v24.8H, v7.H[0]              // ............................................*.......................................................
        // gap                                   // ....................................................................................................
        ins v18.d[0], x17                        // ..*.................................................................................................
        ldr x17, [x0, #136]                      // .........*..........................................................................................
        // gap                                   // ....................................................................................................
        sub v25.8H, v31.8H, v8.8H                // ..................................................*.................................................
        mul v10.8H, v2.8H, v0.H[2]               // .........................................................*..........................................
        ldr x22, [x0, #408]                      // .........................e..........................................................................
        ins v22.d[1], x8                         // ...................e................................................................................
        // gap                                   // ....................................................................................................
        ldr x10, [x0, #472]                      // .............................e......................................................................
        ins v30.d[0], x29                        // ......................e.............................................................................
        sqrdmulh v19.8H, v2.8H, v0.H[3]          // ..........................................................*.........................................
        // gap                                   // ....................................................................................................
        ins v6.d[1], x17                         // ...........*........................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        ins v5.d[1], x21                         // .......*............................................................................................
        // gap                                   // ....................................................................................................
        sqrdmulh v27.8H, v25.8H, v0.H[5]         // ....................................................................*...............................
        ins v16.d[1], x10                        // ...............................e....................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v29.8H, v25.8H, v0.H[4]              // ...................................................................*................................
        ins v18.d[1], x26                        // ...*................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mls v10.8H, v19.8H, v7.H[0]              // ...........................................................*........................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        add v2.8H, v6.8H, v13.8H                 // ..............................................*.....................................................
        mls v29.8H, v27.8H, v7.H[0]              // .....................................................................*..............................
        add v21.8H, v5.8H, v3.8H                 // .........................................*..........................................................
        // gap                                   // ....................................................................................................
        sub v15.8H, v6.8H, v13.8H                // .............................................*......................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sqrdmulh v8.8H, v2.8H, v0.H[3]           // .....................................................*..............................................
        sub v6.8H, v18.8H, v20.8H                // ...................................*................................................................
        // gap                                   // ....................................................................................................
        sub v23.8H, v21.8H, v10.8H               // ............................................................*.......................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v2.8H, v2.8H, v0.H[2]                // ....................................................*...............................................
        add v25.8H, v21.8H, v10.8H               // .............................................................*......................................
        // gap                                   // ....................................................................................................
        add v31.8H, v18.8H, v20.8H               // ....................................*...............................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sqrdmulh v27.8H, v23.8H, v1.H[1]         // ..............................................................................*.....................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mls v2.8H, v8.8H, v7.H[0]                // ......................................................*.............................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v20.8H, v23.8H, v1.H[0]              // .............................................................................*......................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mls v20.8H, v27.8H, v7.H[0]              // ...............................................................................*....................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        add v23.8H, v31.8H, v2.8H                // ........................................................*...........................................
        // gap                                   // ....................................................................................................
        sqrdmulh v4.8H, v15.8H, v0.H[5]          // ...............................................................*....................................
        sub v11.8H, v31.8H, v2.8H                // .......................................................*............................................
        sub v2.8H, v5.8H, v3.8H                  // ........................................*...........................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sqrdmulh v31.8H, v25.8H, v0.H[7]         // .........................................................................*..........................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sub v13.8H, v11.8H, v20.8H               // ................................................................................*...................
        add v21.8H, v11.8H, v20.8H               // .................................................................................*..................
        mul v27.8H, v15.8H, v0.H[4]              // ..............................................................*.....................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        add v20.8H, v2.8H, v29.8H                // .......................................................................*............................
        mls v27.8H, v4.8H, v7.H[0]               // ................................................................*...................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v8.8H, v20.8H, v1.H[2]               // ..................................................................................*.................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sub v12.8H, v2.8H, v29.8H                // ......................................................................*.............................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sqrdmulh v3.8H, v20.8H, v1.H[3]          // ...................................................................................*................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sqrdmulh v5.8H, v12.8H, v1.H[5]          // ........................................................................................*...........
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v12.8H, v12.8H, v1.H[4]              // .......................................................................................*............
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mls v8.8H, v3.8H, v7.H[0]                // ....................................................................................*...............
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mls v12.8H, v5.8H, v7.H[0]               // .........................................................................................*..........
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        add v19.8H, v6.8H, v27.8H                // ..................................................................*.................................
        sub v24.8H, v6.8H, v27.8H                // .................................................................*..................................
        // gap                                   // ....................................................................................................
        mul v3.8H, v25.8H, v0.H[6]               // ........................................................................*...........................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mls v3.8H, v31.8H, v7.H[0]               // ..........................................................................*.........................
        // gap                                   // ....................................................................................................
        add v25.8H, v19.8H, v8.8H                // ......................................................................................*.............
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        sub v6.8H, v24.8H, v12.8H                // ..........................................................................................*.........
        sub v8.8H, v19.8H, v8.8H                 // .....................................................................................*..............
        // gap                                   // ....................................................................................................
        sqrdmulh v19.8H, v22.8H, v0.H[1]         // .................................e..................................................................
        add v9.8H, v24.8H, v12.8H                // ...........................................................................................*........
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        mul v20.8H, v22.8H, v0.H[0]              // ................................e...................................................................
        str q6, [x0, #448]                       // ...................................................................................................*
        ins v30.d[1], x23                        // .......................e............................................................................
        str q8, [x0, #320]                       // .................................................................................................*..
        sub v4.8H, v23.8H, v3.8H                 // ...........................................................................*........................
        // gap                                   // ....................................................................................................
        add v11.8H, v23.8H, v3.8H                // ............................................................................*.......................
        sqrdmulh v12.8H, v16.8H, v0.H[1]         // ................................................e...................................................
        str q25, [x0, #256]                      // ................................................................................................*...
        str q13, [x0, #192]                      // ...............................................................................................*....
        // gap                                   // ....................................................................................................
        ldr x10, [x0, #208]                      // ............e.......................................................................................
        str q21, [x0, #128]                      // ..............................................................................................*.....
        mls v20.8H, v19.8H, v7.H[0]              // ..................................e.................................................................
        // gap                                   // ....................................................................................................
        str q4, [x0, #64]                        // .............................................................................................*......
        // gap                                   // ....................................................................................................
        // gap                                   // ....................................................................................................
        str q9, [x0, #384]                       // ..................................................................................................*.
        // gap                                   // ....................................................................................................
        sqrdmulh v18.8H, v30.8H, v0.H[1]         // ......................................e.............................................................
        str q11, [x0], #(16)                     // ............................................................................................*.......
        ins v31.d[0], x10                        // ..............e.....................................................................................
        ldr x26, [x0, #8]                        // .e..................................................................................................
        
        // original source code
        // ldr x10, [x0, #0]                      // ..................*...............................................................................|...................*............................................................................. || .................................................................................*..............................................................
        // ldr x11, [x0, #(0+8)]                  // .................................................................................................e|................................................................................................. || .......................................................................e........................................................................
        // ins v8.d[0], x10                       // ........................*.........................................................................|.........................*....................................................................... || .....................................................................................*..........................................................
        // ins v8.d[1], x11                       // ......................................*...........................................................|.......................................*......................................................... || ............................................................................................*...................................................
        // ldr x10, [x0, #(1*(512/8))]            // ................*.................................................................................|.................*............................................................................... || ................................................................................*...............................................................
        // ldr x11, [x0, #((1*(512/8))+8)]        // .............*....................................................................................|..............*.................................................................................. || ...............................................................................*................................................................
        // ins v9.d[0], x10                       // ......................*...........................................................................|.......................*......................................................................... || ....................................................................................*...........................................................
        // ins v9.d[1], x11                       // ..................................*...............................................................|...................................*............................................................. || ..........................................................................................*.....................................................
        // ldr x10, [x0, #(2*(512/8))]            // ............*.....................................................................................|.............*................................................................................... || ..............................................................................*.................................................................
        // ldr x11, [x0, #((2*(512/8))+8)]        // .........................*........................................................................|..........................*...................................................................... || .....................................................................................*..........................................................
        // ins v10.d[0], x10                      // ...................*..............................................................................|....................*............................................................................ || ..................................................................................*.............................................................
        // ins v10.d[1], x11                      // .................................*................................................................|..................................*.............................................................. || .........................................................................................*......................................................
        // ldr x10, [x0, #(3*(512/8))]            // .........................................................................................e........|..........................................................................................e...... || ...................................................................e............................................................................
        // ldr x11, [x0, #((3*(512/8))+8)]        // .*................................................................................................|..*.............................................................................................. || .........................................................................*......................................................................
        // ins v11.d[0], x10                      // ................................................................................................e.|................................................................................................. || .......................................................................e........................................................................
        // ins v11.d[1], x11                      // .........*........................................................................................|..........*...................................................................................... || .............................................................................*..................................................................
        // ldr x10, [x0, #(4*(512/8))]            // ........e.........................................................................................|.........e....................................................................................... || .....e..........................................................................................................................................
        // ldr x11, [x0, #((4*(512/8))+8)]        // e.................................................................................................|.e............................................................................................... || e...............................................................................................................................................
        // ins v12.d[0], x10                      // .................e................................................................................|..................e.............................................................................. || .........e......................................................................................................................................
        // ins v12.d[1], x11                      // .............................e....................................................................|..............................e.................................................................. || ...............e................................................................................................................................
        // ldr x10, [x0, #(5*(512/8))]            // ......e...........................................................................................|.......e......................................................................................... || ....e...........................................................................................................................................
        // ldr x11, [x0, #((5*(512/8))+8)]        // .....e............................................................................................|......e.......................................................................................... || ...e............................................................................................................................................
        // ins v13.d[0], x10                      // ...............................e..................................................................|................................e................................................................ || ................e...............................................................................................................................
        // ins v13.d[1], x11                      // ..................................................................................e...............|...................................................................................e............. || ................................................................e...............................................................................
        // ldr x10, [x0, #(6*(512/8))]            // ..e...............................................................................................|...e............................................................................................. || ..e.............................................................................................................................................
        // ldr x11, [x0, #((6*(512/8))+8)]        // ............................e.....................................................................|.............................e................................................................... || ..............e.................................................................................................................................
        // ins v14.d[0], x10                      // ...............e..................................................................................|................e................................................................................ || ........e.......................................................................................................................................
        // ins v14.d[1], x11                      // ..................................................................................................*................................................................................................. || ........................................................................*.......................................................................
        // ldr x10, [x0, #(7*(512/8))]            // ....e.............................................................................................|.....e........................................................................................... || ..e.............................................................................................................................................
        // ldr x11, [x0, #((7*(512/8))+8)]        // ..............................e...................................................................|...............................e................................................................. || ...............e................................................................................................................................
        // ins v15.d[0], x10                      // ..........e.......................................................................................|...........e..................................................................................... || ......e.........................................................................................................................................
        // ins v15.d[1], x11                      // ....................................e.............................................................|.....................................e........................................................... || ...................e............................................................................................................................
        // mul v24.8h, v12.8h, v0.h[0]            // ................................................................................e.................|.................................................................................e............... || ................................................................e...............................................................................
        // sqrdmulh v12.8h, v12.8h, v0.h[1]       // ..............................................................................e...................|...............................................................................e................. || ..............................................................e.................................................................................
        // mls v24.8h, v12.8h, v7.h[0]            // ...........................................................................................e......|............................................................................................e.... || ....................................................................e...........................................................................
        // sub     v12.8h,    v8.8h, v24.8h       // .............................................*....................................................|..............................................*.................................................. || ..................................................................................................*.............................................
        // add     v8.8h,    v8.8h, v24.8h        // .................................................*................................................|..................................................*.............................................. || .....................................................................................................*..........................................
        // mul v24.8h, v13.8h, v0.h[0]            // ..................................................................................................|*................................................................................................ || ........................................................................*.......................................................................
        // sqrdmulh v13.8h, v13.8h, v0.h[1]       // ..............................................................................................e...|...............................................................................................e. || ......................................................................e.........................................................................
        // mls v24.8h, v13.8h, v7.h[0]            // ....................*.............................................................................|.....................*........................................................................... || ..................................................................................*.............................................................
        // sub     v13.8h,    v9.8h, v24.8h       // .........................................................*........................................|..........................................................*...................................... || ...............................................................................................................*................................
        // add     v9.8h,    v9.8h, v24.8h        // ..........................................*.......................................................|...........................................*..................................................... || ................................................................................................*...............................................
        // mul v24.8h, v14.8h, v0.h[0]            // ..............*...................................................................................|...............*................................................................................. || ................................................................................*...............................................................
        // sqrdmulh v14.8h, v14.8h, v0.h[1]       // ...........*......................................................................................|............*.................................................................................... || ..............................................................................*.................................................................
        // mls v24.8h, v14.8h, v7.h[0]            // .......................*..........................................................................|........................*........................................................................ || ....................................................................................*...........................................................
        // sub     v14.8h,    v10.8h, v24.8h      // ...........................................*......................................................|............................................*.................................................... || .................................................................................................*..............................................
        // add     v10.8h,    v10.8h, v24.8h      // ........................................*.........................................................|.........................................*....................................................... || ...............................................................................................*................................................
        // mul v24.8h, v15.8h, v0.h[0]            // ...*..............................................................................................|....*............................................................................................ || ..........................................................................*.....................................................................
        // sqrdmulh v15.8h, v15.8h, v0.h[1]       // ......................................................................................e...........|.......................................................................................e......... || ..................................................................e.............................................................................
        // mls v24.8h, v15.8h, v7.h[0]            // .......*..........................................................................................|........*........................................................................................ || ............................................................................*...................................................................
        // sub     v15.8h,    v11.8h, v24.8h      // ..........................*.......................................................................|...........................*..................................................................... || ......................................................................................*.........................................................
        // add     v11.8h,    v11.8h, v24.8h      // .....................*............................................................................|......................*.......................................................................... || ...................................................................................*............................................................
        // mul v24.8h, v10.8h, v0.h[2]            // ...............................................*..................................................|................................................*................................................ || ....................................................................................................*...........................................
        // sqrdmulh v10.8h, v10.8h, v0.h[3]       // ............................................*.....................................................|.............................................*................................................... || ..................................................................................................*.............................................
        // mls v24.8h, v10.8h, v7.h[0]            // ...................................................*..............................................|....................................................*............................................ || ........................................................................................................*.......................................
        // sub     v10.8h,    v8.8h, v24.8h       // ........................................................*.........................................|.........................................................*....................................... || ..............................................................................................................*.................................
        // add     v8.8h,    v8.8h, v24.8h        // ......................................................*...........................................|.......................................................*......................................... || .............................................................................................................*..................................
        // mul v24.8h, v11.8h, v0.h[2]            // ...........................*......................................................................|............................*.................................................................... || ......................................................................................*.........................................................
        // sqrdmulh v11.8h, v11.8h, v0.h[3]       // ................................*.................................................................|.................................*............................................................... || ........................................................................................*.......................................................
        // mls v24.8h, v11.8h, v7.h[0]            // .......................................*..........................................................|........................................*........................................................ || ..............................................................................................*.................................................
        // sub     v11.8h,    v9.8h, v24.8h       // ..............................................*...................................................|...............................................*................................................. || ...................................................................................................*............................................
        // add     v9.8h,    v9.8h, v24.8h        // ................................................*.................................................|.................................................*............................................... || ....................................................................................................*...........................................
        // mul v24.8h, v14.8h, v0.h[4]            // .............................................................*....................................|..............................................................*.................................. || ..................................................................................................................*.............................
        // sqrdmulh v14.8h, v14.8h, v0.h[5]       // .......................................................*..........................................|........................................................*........................................ || ..............................................................................................................*.................................
        // mls v24.8h, v14.8h, v7.h[0]            // ...............................................................*..................................|................................................................*................................ || ....................................................................................................................*...........................
        // sub     v14.8h,    v12.8h, v24.8h      // ........................................................................*.........................|.........................................................................*....................... || ..................................................................................................................................*.............
        // add     v12.8h,    v12.8h, v24.8h      // .......................................................................*..........................|........................................................................*........................ || .................................................................................................................................*..............
        // mul v24.8h, v15.8h, v0.h[4]            // .....................................*............................................................|......................................*.......................................................... || ............................................................................................*...................................................
        // sqrdmulh v15.8h, v15.8h, v0.h[5]       // ...................................*..............................................................|....................................*............................................................ || ..........................................................................................*.....................................................
        // mls v24.8h, v15.8h, v7.h[0]            // .........................................*........................................................|..........................................*...................................................... || ................................................................................................*...............................................
        // sub     v15.8h,    v13.8h, v24.8h      // .................................................................*................................|..................................................................*.............................. || .......................................................................................................................*........................
        // add     v13.8h,    v13.8h, v24.8h      // ..............................................................*...................................|...............................................................*................................. || ...................................................................................................................*............................
        // mul v24.8h, v9.8h, v0.h[6]             // .........................................................................*........................|..........................................................................*...................... || ..................................................................................................................................*.............
        // sqrdmulh v9.8h, v9.8h, v0.h[7]         // ..........................................................*.......................................|...........................................................*..................................... || ................................................................................................................*...............................
        // mls v24.8h, v9.8h, v7.h[0]             // ..........................................................................*.......................|...........................................................................*..................... || ....................................................................................................................................*...........
        // sub     v9.8h,    v8.8h, v24.8h        // ....................................................................................*.............|.....................................................................................*........... || .........................................................................................................................................*......
        // add     v8.8h,    v8.8h, v24.8h        // .....................................................................................*............|......................................................................................*.......... || ..........................................................................................................................................*.....
        // mul v24.8h, v11.8h, v1.h[0]            // ....................................................*.............................................|.....................................................*........................................... || ..........................................................................................................*.....................................
        // sqrdmulh v11.8h, v11.8h, v1.h[1]       // ..................................................*...............................................|...................................................*............................................. || ......................................................................................................*.........................................
        // mls v24.8h, v11.8h, v7.h[0]            // .....................................................*............................................|......................................................*.......................................... || ............................................................................................................*...................................
        // sub     v11.8h,    v10.8h, v24.8h      // ...........................................................*......................................|............................................................*.................................... || .................................................................................................................*..............................
        // add     v10.8h,    v10.8h, v24.8h      // ............................................................*.....................................|.............................................................*................................... || ..................................................................................................................*.............................
        // mul v24.8h, v13.8h, v1.h[2]            // ................................................................*.................................|.................................................................*............................... || ......................................................................................................................*.........................
        // sqrdmulh v13.8h, v13.8h, v1.h[3]       // ..................................................................*...............................|...................................................................*............................. || ........................................................................................................................*.......................
        // mls v24.8h, v13.8h, v7.h[0]            // .....................................................................*............................|......................................................................*.......................... || ..............................................................................................................................*.................
        // sub     v13.8h,    v12.8h, v24.8h      // .............................................................................*....................|..............................................................................*.................. || ......................................................................................................................................*.........
        // add     v12.8h,    v12.8h, v24.8h      // ...........................................................................*......................|............................................................................*.................... || ....................................................................................................................................*...........
        // mul v24.8h, v15.8h, v1.h[4]            // ....................................................................*.............................|.....................................................................*........................... || ............................................................................................................................*...................
        // sqrdmulh v15.8h, v15.8h, v1.h[5]       // ...................................................................*..............................|....................................................................*............................ || ..........................................................................................................................*.....................
        // mls v24.8h, v15.8h, v7.h[0]            // ......................................................................*...........................|.......................................................................*......................... || ................................................................................................................................*...............
        // sub     v15.8h,    v14.8h, v24.8h      // ............................................................................*.....................|.............................................................................*................... || .....................................................................................................................................*..........
        // add     v14.8h,    v14.8h, v24.8h      // ...............................................................................*..................|................................................................................*................ || .......................................................................................................................................*........
        // str q8, [x0], #(16)                    // ...............................................................................................*..|................................................................................................* || ...............................................................................................................................................*
        // str q9, [x0, #(-16 + 1*(512/8))]       // ............................................................................................*.....|.............................................................................................*... || .............................................................................................................................................*..
        // str q10, [x0, #(-16 + 2*(512/8))]      // ..........................................................................................*.......|...........................................................................................*..... || ............................................................................................................................................*...
        // str q11, [x0, #(-16 + 3*(512/8))]      // ........................................................................................*.........|.........................................................................................*....... || ...........................................................................................................................................*....
        // str q12, [x0, #(-16 + 4*(512/8))]      // .......................................................................................*..........|........................................................................................*........ || ..........................................................................................................................................*.....
        // str q13, [x0, #(-16 + 5*(512/8))]      // ...................................................................................*..............|....................................................................................*............ || .........................................................................................................................................*......
        // str q14, [x0, #(-16 + 6*(512/8))]      // .............................................................................................*....|..............................................................................................*.. || ..............................................................................................................................................*.
        // str q15, [x0, #(-16 + 7*(512/8))]      // .................................................................................*................|..................................................................................*.............. || ........................................................................................................................................*.......
        
        sub count, count, #1
        cbnz count, layer123_start
        ins v14.d[1], x22                        // *............................................................................
        mul v21.8H, v30.8H, v0.H[0]              // .*...........................................................................
        ldr x10, [x0, #200]                      // ..*..........................................................................
        ldr x20, [x0, #0]                        // ...........*.................................................................
        ldr x29, [x0, #128]                      // .......*.....................................................................
        // gap                                   // .............................................................................
        mul v16.8H, v16.8H, v0.H[0]              // ...*.........................................................................
        ldr x18, [x0, #64]                       // ..........*..................................................................
        ldr x22, [x0, #72]                       // ........*....................................................................
        ldr x17, [x0, #136]                      // ..................*..........................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v16.8H, v12.8H, v7.H[0]              // ....*........................................................................
        ins v31.d[1], x10                        // .....*.......................................................................
        // gap                                   // .............................................................................
        ins v29.d[0], x20                        // .................*...........................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        ins v10.d[0], x29                        // ............*................................................................
        sqrdmulh v27.8H, v14.8H, v0.H[1]         // ......*......................................................................
        // gap                                   // .............................................................................
        ins v5.d[0], x18                         // ...............*.............................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v21.8H, v18.8H, v7.H[0]              // .............*...............................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v14.8H, v14.8H, v0.H[0]              // .........*...................................................................
        add v3.8H, v31.8H, v16.8H                // ..............*..............................................................
        // gap                                   // .............................................................................
        ins v29.d[1], x26                        // ..........................*..................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        ins v10.d[1], x17                        // ......................*......................................................
        mls v14.8H, v27.8H, v7.H[0]              // ................*............................................................
        // gap                                   // .............................................................................
        ins v5.d[1], x22                         // .......................*.....................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v16.8H, v31.8H, v16.8H               // ...................*.........................................................
        mul v31.8H, v3.8H, v0.H[2]               // ....................*........................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sqrdmulh v27.8H, v3.8H, v0.H[3]          // .....................*.......................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v3.8H, v29.8H, v20.8H                // .................................*...........................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        add v20.8H, v29.8H, v20.8H               // .....................................*.......................................
        sqrdmulh v29.8H, v16.8H, v0.H[5]         // ........................*....................................................
        // gap                                   // .............................................................................
        add v6.8H, v10.8H, v14.8H                // ............................*................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v16.8H, v16.8H, v0.H[4]              // .........................*...................................................
        add v9.8H, v5.8H, v21.8H                 // ..............................*..............................................
        // gap                                   // .............................................................................
        sub v14.8H, v10.8H, v14.8H               // ...............................*.............................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v21.8H, v5.8H, v21.8H                // .............................................*...............................
        mls v31.8H, v27.8H, v7.H[0]              // ...........................*.................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v16.8H, v29.8H, v7.H[0]              // .............................*...............................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sqrdmulh v29.8H, v6.8H, v0.H[3]          // ................................*............................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v10.8H, v9.8H, v31.8H                // ..................................*..........................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v27.8H, v6.8H, v0.H[2]               // ...................................*.........................................
        add v31.8H, v9.8H, v31.8H                // ....................................*........................................
        // gap                                   // .............................................................................
        add v5.8H, v21.8H, v16.8H                // ..................................................*..........................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v21.8H, v21.8H, v16.8H               // .....................................................*.......................
        sqrdmulh v16.8H, v10.8H, v1.H[1]         // ......................................*......................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v27.8H, v29.8H, v7.H[0]              // .......................................*.....................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v29.8H, v10.8H, v1.H[0]              // ........................................*....................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v29.8H, v16.8H, v7.H[0]              // .........................................*...................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        add v16.8H, v20.8H, v27.8H               // ..........................................*..................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v20.8H, v20.8H, v27.8H               // ............................................*................................
        sqrdmulh v10.8H, v14.8H, v0.H[5]         // ...........................................*.................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sqrdmulh v27.8H, v31.8H, v0.H[7]         // ..............................................*..............................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v6.8H, v20.8H, v29.8H                // ...............................................*.............................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v14.8H, v14.8H, v0.H[4]              // .................................................*...........................
        add v20.8H, v20.8H, v29.8H               // ................................................*............................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v14.8H, v10.8H, v7.H[0]              // ...................................................*.........................
        str q6, [x0, #192]                       // ........................................................................*....
        // gap                                   // .............................................................................
        str q20, [x0, #128]                      // .........................................................................*...
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v20.8H, v5.8H, v1.H[2]               // ....................................................*........................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sqrdmulh v29.8H, v5.8H, v1.H[3]          // ......................................................*......................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        add v10.8H, v3.8H, v14.8H                // ...........................................................*.................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v14.8H, v3.8H, v14.8H                // ............................................................*................
        sqrdmulh v5.8H, v21.8H, v1.H[5]          // .......................................................*.....................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v21.8H, v21.8H, v1.H[4]              // ........................................................*....................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v20.8H, v29.8H, v7.H[0]              // .........................................................*...................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v21.8H, v5.8H, v7.H[0]               // ..........................................................*..................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mul v31.8H, v31.8H, v0.H[6]              // .............................................................*...............
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v29.8H, v10.8H, v20.8H               // .................................................................*...........
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        mls v31.8H, v27.8H, v7.H[0]              // ..............................................................*..............
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v27.8H, v14.8H, v21.8H               // ................................................................*............
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        add v20.8H, v10.8H, v20.8H               // ...............................................................*.............
        add v21.8H, v14.8H, v21.8H               // ..................................................................*..........
        str q29, [x0, #320]                      // ....................................................................*........
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        str q27, [x0, #448]                      // ...................................................................*.........
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        sub v14.8H, v16.8H, v31.8H               // .....................................................................*.......
        add v16.8H, v16.8H, v31.8H               // ......................................................................*......
        str q20, [x0, #256]                      // .......................................................................*.....
        str q21, [x0, #384]                      // ...........................................................................*.
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        // gap                                   // .............................................................................
        str q14, [x0, #64]                       // ..........................................................................*..
        str q16, [x0], #(16)                     // ............................................................................*
        // gap                                   // .............................................................................
        
        // original source code
        // ins v14.d[1], x22                     // *............................................................................ || *....................................................................
        // mul v3.8H, v30.8H, v0.H[0]            // .*........................................................................... || *....................................................................
        // ldr x16, [x0, #200]                   // ..*.......................................................................... || *....................................................................
        // mul v8.8H, v16.8H, v0.H[0]            // .....*....................................................................... || ..*..................................................................
        // mls v8.8H, v12.8H, v7.H[0]            // .........*................................................................... || ....*................................................................
        // ins v31.d[1], x16                     // ..........*.................................................................. || ....*................................................................
        // sqrdmulh v24.8H, v14.8H, v0.H[1]      // .............*............................................................... || ......*..............................................................
        // ldr x19, [x0, #128]                   // ....*........................................................................ || .*...................................................................
        // ldr x21, [x0, #72]                    // .......*..................................................................... || ..*..................................................................
        // mul v13.8H, v14.8H, v0.H[0]           // ................*............................................................ || ..........*..........................................................
        // ldr x14, [x0, #64]                    // ......*...................................................................... || ..*..................................................................
        // ldr x17, [x0, #0]                     // ...*......................................................................... || .*...................................................................
        // ins v6.d[0], x19                      // ............*................................................................ || ......*..............................................................
        // mls v3.8H, v18.8H, v7.H[0]            // ...............*............................................................. || ........*............................................................
        // add v2.8H, v31.8H, v8.8H              // .................*........................................................... || ..........*..........................................................
        // ins v5.d[0], x14                      // ..............*.............................................................. || .......*.............................................................
        // mls v13.8H, v24.8H, v7.H[0]           // ....................*........................................................ || ............*........................................................
        // ins v18.d[0], x17                     // ...........*................................................................. || .....*...............................................................
        // ldr x17, [x0, #136]                   // ........*.................................................................... || ...*.................................................................
        // sub v25.8H, v31.8H, v8.8H             // ......................*...................................................... || ..............*......................................................
        // mul v10.8H, v2.8H, v0.H[2]            // .......................*..................................................... || ..............*......................................................
        // sqrdmulh v19.8H, v2.8H, v0.H[3]       // ........................*.................................................... || ................*....................................................
        // ins v6.d[1], x17                      // ...................*......................................................... || ............*........................................................
        // ins v5.d[1], x21                      // .....................*....................................................... || .............*.......................................................
        // sqrdmulh v27.8H, v25.8H, v0.H[5]      // ...........................*................................................. || ..................*..................................................
        // mul v29.8H, v25.8H, v0.H[4]           // .............................*............................................... || ....................*................................................
        // ins v18.d[1], x26                     // ..................*.......................................................... || ...........*.........................................................
        // mls v10.8H, v19.8H, v7.H[0]           // .................................*........................................... || ......................*..............................................
        // add v2.8H, v6.8H, v13.8H              // ............................*................................................ || ...................*.................................................
        // mls v29.8H, v27.8H, v7.H[0]           // ..................................*.......................................... || ........................*............................................
        // add v21.8H, v5.8H, v3.8H              // ..............................*.............................................. || ....................*................................................
        // sub v15.8H, v6.8H, v13.8H             // ...............................*............................................. || .....................*...............................................
        // sqrdmulh v8.8H, v2.8H, v0.H[3]        // ...................................*......................................... || ..........................*..........................................
        // sub v6.8H, v18.8H, v20.8H             // .........................*................................................... || .................*...................................................
        // sub v23.8H, v21.8H, v10.8H            // ....................................*........................................ || ...........................*.........................................
        // mul v2.8H, v2.8H, v0.H[2]             // .....................................*....................................... || ............................*........................................
        // add v25.8H, v21.8H, v10.8H            // ......................................*...................................... || ............................*........................................
        // add v31.8H, v18.8H, v20.8H            // ..........................*.................................................. || ..................*..................................................
        // sqrdmulh v27.8H, v23.8H, v1.H[1]      // .........................................*................................... || ..............................*......................................
        // mls v2.8H, v8.8H, v7.H[0]             // ..........................................*.................................. || ................................*....................................
        // mul v20.8H, v23.8H, v1.H[0]           // ...........................................*................................. || ..................................*..................................
        // mls v20.8H, v27.8H, v7.H[0]           // ............................................*................................ || ....................................*................................
        // add v23.8H, v31.8H, v2.8H             // .............................................*............................... || .....................................*...............................
        // sqrdmulh v4.8H, v15.8H, v0.H[5]       // ...............................................*............................. || ......................................*..............................
        // sub v11.8H, v31.8H, v2.8H             // ..............................................*.............................. || ......................................*..............................
        // sub v2.8H, v5.8H, v3.8H               // ................................*............................................ || ......................*..............................................
        // sqrdmulh v31.8H, v25.8H, v0.H[7]      // ................................................*............................ || ........................................*............................
        // sub v13.8H, v11.8H, v20.8H            // .................................................*........................... || .........................................*...........................
        // add v21.8H, v11.8H, v20.8H            // ...................................................*......................... || ..........................................*..........................
        // mul v27.8H, v15.8H, v0.H[4]           // ..................................................*.......................... || ..........................................*..........................
        // add v20.8H, v2.8H, v29.8H             // .......................................*..................................... || .............................*.......................................
        // mls v27.8H, v4.8H, v7.H[0]            // ....................................................*........................ || ............................................*........................
        // mul v8.8H, v20.8H, v1.H[2]            // .......................................................*..................... || ..............................................*......................
        // sub v12.8H, v2.8H, v29.8H             // ........................................*.................................... || ..............................*......................................
        // sqrdmulh v3.8H, v20.8H, v1.H[3]       // ........................................................*.................... || ................................................*....................
        // sqrdmulh v5.8H, v12.8H, v1.H[5]       // ...........................................................*................. || ..................................................*..................
        // mul v12.8H, v12.8H, v1.H[4]           // ............................................................*................ || ....................................................*................
        // mls v8.8H, v3.8H, v7.H[0]             // .............................................................*............... || ......................................................*..............
        // mls v12.8H, v5.8H, v7.H[0]            // ..............................................................*.............. || ........................................................*............
        // add v19.8H, v6.8H, v27.8H             // .........................................................*................... || .................................................*...................
        // sub v24.8H, v6.8H, v27.8H             // ..........................................................*.................. || ..................................................*..................
        // mul v3.8H, v25.8H, v0.H[6]            // ...............................................................*............. || ..........................................................*..........
        // mls v3.8H, v31.8H, v7.H[0]            // .................................................................*........... || ............................................................*........
        // add v25.8H, v19.8H, v8.8H             // ...................................................................*......... || ..............................................................*......
        // sub v6.8H, v24.8H, v12.8H             // ..................................................................*.......... || .............................................................*.......
        // sub v8.8H, v19.8H, v8.8H              // ................................................................*............ || ...........................................................*.........
        // add v9.8H, v24.8H, v12.8H             // ....................................................................*........ || ..............................................................*......
        // str q6, [x0, #448]                    // ......................................................................*...... || ................................................................*....
        // str q8, [x0, #320]                    // .....................................................................*....... || ..............................................................*......
        // sub v4.8H, v23.8H, v3.8H              // .......................................................................*..... || .................................................................*...
        // add v11.8H, v23.8H, v3.8H             // ........................................................................*.... || .................................................................*...
        // str q25, [x0, #256]                   // .........................................................................*... || .................................................................*...
        // str q13, [x0, #192]                   // .....................................................*....................... || ............................................*........................
        // str q21, [x0, #128]                   // ......................................................*...................... || .............................................*.......................
        // str q4, [x0, #64]                     // ...........................................................................*. || ....................................................................*
        // str q9, [x0, #384]                    // ..........................................................................*.. || ..................................................................*..
        // str q11, [x0], #(16)                  // ............................................................................* || ....................................................................*
        

        restore inp, STACK0
        mov count, #8

        .p2align 2
        ldr x10, [x3], #16                       // *..........................................................................
        ldr x8, [x1, #48]                        // ....*......................................................................
        // gap                                   // ...........................................................................
        ldr x14, [x4, #56]                       // .*.........................................................................
        ldr x17, [x4, #80]                       // ......*....................................................................
        // gap                                   // ...........................................................................
        ldr x26, [x4], #(6*16)                   // ..*........................................................................
        ldr x15, [x4, #-24]                      // .....*.....................................................................
        // gap                                   // ...........................................................................
        ldr x19, [x1, #32]                       // ..........*................................................................
        ldr x20, [x4, #-8]                       // .........................*.................................................
        // gap                                   // ...........................................................................
        ins v9.d[0], x10                         // .......*...................................................................
        ins v21.d[0], x8                         // ...........*...............................................................
        ldr x10, [x4, #-80]                      // ..................*........................................................
        ins v19.d[0], x17                        // .............*.............................................................
        // gap                                   // ...........................................................................
        ldr x23, [x3, #-8]                       // ............*..............................................................
        ldr x29, [x1, #56]                       // ................*..........................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v18.d[0], x19                        // .................*.........................................................
        ldr x18, [x1, #24]                       // .............................*.............................................
        // gap                                   // ...........................................................................
        ins v6.d[0], x10                         // ..........................*................................................
        ldr x10, [x1, #40]                       // ...................*.......................................................
        // gap                                   // ...........................................................................
        ldr x16, [x1, #16]                       // .....................*.....................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v9.d[1], x23                         // ....................*......................................................
        ins v21.d[1], x29                        // ........................*..................................................
        ldr x24, [x4, #-72]                      // .......................*...................................................
        ins v19.d[1], x20                        // ..........................................*................................
        ldr x22, [x4, #-56]                      // ...............................................*...........................
        // gap                                   // ...........................................................................
        ldr x12, [x4, #-88]                      // ..............*............................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v18.d[1], x10                        // ..............................*............................................
        ins v16.d[0], x16                        // ............................*..............................................
        ldr x10, [x4, #-64]                      // ...............................*...........................................
        ins v6.d[1], x24                         // ..................................*........................................
        ldr x29, [x4, #-48]                      // ...........................*...............................................
        // gap                                   // ...........................................................................
        ldr x19, [x1, #0]                        // ...*.......................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sqrdmulh v10.8H, v21.8H, v9.H[1]         // .................................*.........................................
        ldr x24, [x4, #-32]                      // ........*..................................................................
        // gap                                   // ...........................................................................
        ins v26.d[0], x10                        // ..............................................*............................
        ldr x11, [x1, #8]                        // .....................................*.....................................
        // gap                                   // ...........................................................................
        mul v21.8H, v21.8H, v9.H[0]              // ...................................*.......................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v3.d[0], x19                         // .........................................*.................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sqrdmulh v13.8H, v18.8H, v9.H[1]         // ......................................*....................................
        ins v16.d[1], x18                        // ....................................*......................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mls v21.8H, v10.8H, v7.H[0]              // .......................................*...................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v26.d[1], x22                        // ....................................................*......................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mul v15.8H, v18.8H, v9.H[0]              // ........................................*..................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v3.d[1], x11                         // .................................................*.........................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sub v28.8H, v16.8H, v21.8H               // ............................................*..............................
        add v27.8H, v16.8H, v21.8H               // ...........................................*...............................
        // gap                                   // ...........................................................................
        mls v15.8H, v13.8H, v7.H[0]              // .............................................*.............................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sqrdmulh v30.8H, v28.8H, v9.H[5]         // ...................................................*.......................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mul v21.8H, v28.8H, v9.H[4]              // .....................................................*.....................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        add v2.8H, v3.8H, v15.8H                 // .......................................................*...................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sub v29.8H, v3.8H, v15.8H                // ......................................................*....................
        sqrdmulh v10.8H, v27.8H, v9.H[3]         // ..................................................*........................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mls v21.8H, v30.8H, v7.H[0]              // .........................................................*.................
        ins v30.d[0], x24                        // ...............*...........................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mul v4.8H, v27.8H, v9.H[2]               // ................................................*..........................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mls v4.8H, v10.8H, v7.H[0]               // ........................................................*..................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        add v31.8H, v29.8H, v21.8H               // .............................................................*.............
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v30.d[1], x15                        // ................................*..........................................
        sub v16.8H, v29.8H, v21.8H               // ............................................................*..............
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        ins v29.d[0], x26                        // .........*.................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sub v1.8H, v2.8H, v4.8H                  // ..........................................................*................
        add v9.8H, v2.8H, v4.8H                  // ...........................................................*...............
        // gap                                   // ...........................................................................
        trn2 v14.4S, v31.4S, v16.4S              // ...............................................................*...........
        trn1 v17.4S, v31.4S, v16.4S              // ..................................................................*........
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        trn2 v21.4S, v9.4S, v1.4S                // ..............................................................*............
        trn1 v1.4S, v9.4S, v1.4S                 // ................................................................*..........
        // gap                                   // ...........................................................................
        ins v31.d[0], x29                        // ...................................................................*.......
        ins v29.d[1], x12                        // ......................*....................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        trn2 v3.2D, v21.2D, v14.2D               // .................................................................*.........
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        trn2 v24.2D, v1.2D, v17.2D               // ......................................................................*....
        trn1 v9.2D, v21.2D, v14.2D               // ....................................................................*......
        // gap                                   // ...........................................................................
        trn1 v20.2D, v1.2D, v17.2D               // .........................................................................*.
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sqrdmulh v1.8H, v3.8H, v6.8H             // .....................................................................*.....
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        sqrdmulh v0.8H, v24.8H, v6.8H            // ..........................................................................*
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mul v25.8H, v3.8H, v29.8H                // .......................................................................*...
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        mls v25.8H, v1.8H, v7.H[0]               // ........................................................................*..
        // gap                                   // ...........................................................................
        // gap                                   // ...........................................................................
        
        // original source code
        // ldr x28, [x3], #16                    // *.......................................................................... || *............................................................
        // ldr x14, [x4, #56]                    // ..*........................................................................ || .*...........................................................
        // ldr x11, [x4], #(6*16)                // ....*...................................................................... || ..*..........................................................
        // ldr x26, [x1, #0]                     // ..............................*............................................ || ...............*.............................................
        // ldr x17, [x1, #48]                    // .*......................................................................... || *............................................................
        // ldr x18, [x4, #-24]                   // .....*..................................................................... || ..*..........................................................
        // ldr x27, [x4, #-16]                   // ...*....................................................................... || .*...........................................................
        // ins v6.d[0], x28                      // ........*.................................................................. || ....*........................................................
        // ldr x20, [x4, #-32]                   // ................................*.......................................... || ................*............................................
        // ins v29.d[0], x11                     // ..........................................................*................ || ...........................................*.................
        // ldr x22, [x1, #32]                    // ......*.................................................................... || ...*.........................................................
        // ins v4.d[0], x17                      // .........*................................................................. || ....*........................................................
        // ldr x8, [x3, #-8]                     // ............*.............................................................. || .....*.......................................................
        // ins v19.d[0], x27                     // ...........*............................................................... || .....*.......................................................
        // ldr x13, [x4, #-88]                   // ........................*.................................................. || ............*................................................
        // ins v30.d[0], x20                     // ....................................................*...................... || ....................................*........................
        // ldr x24, [x1, #56]                    // .............*............................................................. || ......*......................................................
        // ins v17.d[0], x22                     // ..............*............................................................ || .......*.....................................................
        // ldr x17, [x4, #-80]                   // ..........*................................................................ || ....*........................................................
        // ldr x15, [x1, #40]                    // .................*......................................................... || ........*....................................................
        // ins v6.d[1], x8                       // ...................*....................................................... || ..........*..................................................
        // ldr x29, [x1, #16]                    // ..................*........................................................ || .........*...................................................
        // ins v29.d[1], x13                     // ..................................................................*........ || .................................................*...........
        // ldr x16, [x4, #-72]                   // .....................*..................................................... || ..........*..................................................
        // ins v4.d[1], x24                      // ....................*...................................................... || ..........*..................................................
        // ldr x23, [x4, #-8]                    // .......*................................................................... || ...*.........................................................
        // ins v18.d[0], x17                     // ................*.......................................................... || ........*....................................................
        // ldr x7, [x4, #-48]                    // .............................*............................................. || ..............*..............................................
        // ins v5.d[0], x29                      // ..........................*................................................ || .............*...............................................
        // ldr x10, [x1, #24]                    // ...............*........................................................... || .......*.....................................................
        // ins v17.d[1], x15                     // .........................*................................................. || .............*...............................................
        // ldr x15, [x4, #-64]                   // ...........................*............................................... || .............*...............................................
        // ins v30.d[1], x18                     // ........................................................*.................. || ..........................................*..................
        // sqrdmulh v12.8H, v4.8H, v6.H[1]       // ...............................*........................................... || ................*............................................
        // ins v18.d[1], x16                     // ............................*.............................................. || ..............*..............................................
        // mul v10.8H, v4.8H, v6.H[0]            // ...................................*....................................... || ..................*..........................................
        // ins v5.d[1], x10                      // ......................................*.................................... || ....................*........................................
        // ldr x10, [x1, #8]                     // ..................................*........................................ || .................*...........................................
        // sqrdmulh v16.8H, v17.8H, v6.H[1]      // .....................................*..................................... || ....................*........................................
        // mls v10.8H, v12.8H, v7.H[0]           // .......................................*................................... || ......................*......................................
        // mul v28.8H, v17.8H, v6.H[0]           // .........................................*................................. || ........................*....................................
        // ins v23.d[0], x26                     // ....................................*...................................... || ...................*.........................................
        // ins v19.d[1], x23                     // ......................*.................................................... || ...........*.................................................
        // add v17.8H, v5.8H, v10.8H             // ............................................*.............................. || ...........................*.................................
        // sub v9.8H, v5.8H, v10.8H              // ...........................................*............................... || ...........................*.................................
        // mls v28.8H, v16.8H, v7.H[0]           // .............................................*............................. || ............................*................................
        // ins v26.d[0], x15                     // .................................*......................................... || .................*...........................................
        // ldr x15, [x4, #-56]                   // .......................*................................................... || ...........*.................................................
        // mul v0.8H, v17.8H, v6.H[2]            // .....................................................*..................... || ......................................*......................
        // ins v23.d[1], x10                     // ..........................................*................................ || .........................*...................................
        // sqrdmulh v1.8H, v17.8H, v6.H[3]       // ..................................................*........................ || ..................................*..........................
        // sqrdmulh v22.8H, v9.8H, v6.H[5]       // ..............................................*............................ || ..............................*..............................
        // ins v26.d[1], x15                     // ........................................*.................................. || .......................*.....................................
        // mul v2.8H, v9.8H, v6.H[4]             // ...............................................*........................... || ................................*............................
        // sub v8.8H, v23.8H, v28.8H             // .................................................*......................... || ..................................*..........................
        // add v31.8H, v23.8H, v28.8H            // ................................................*.......................... || .................................*...........................
        // mls v0.8H, v1.8H, v7.H[0]             // ......................................................*.................... || ........................................*....................
        // mls v2.8H, v22.8H, v7.H[0]            // ...................................................*....................... || ....................................*........................
        // sub v24.8H, v31.8H, v0.8H             // ...........................................................*............... || .............................................*...............
        // add v16.8H, v31.8H, v0.8H             // ............................................................*.............. || .............................................*...............
        // sub v14.8H, v8.8H, v2.8H              // .........................................................*................. || ..........................................*..................
        // add v31.8H, v8.8H, v2.8H              // .......................................................*................... || .........................................*...................
        // trn2 v17.4S, v16.4S, v24.4S           // ...............................................................*........... || ................................................*............
        // trn2 v11.4S, v31.4S, v14.4S           // .............................................................*............. || ..............................................*..............
        // trn1 v4.4S, v16.4S, v24.4S            // ................................................................*.......... || ................................................*............
        // trn2 v8.2D, v17.2D, v11.2D            // ...................................................................*....... || ...................................................*.........
        // trn1 v28.4S, v31.4S, v14.4S           // ..............................................................*............ || ..............................................*..............
        // ins v31.d[0], x7                      // .................................................................*......... || .................................................*...........
        // trn1 v9.2D, v17.2D, v11.2D            // .....................................................................*..... || ....................................................*........
        // sqrdmulh v20.8H, v8.8H, v18.8H        // .......................................................................*... || ......................................................*......
        // trn2 v24.2D, v4.2D, v28.2D            // ....................................................................*...... || ....................................................*........
        // mul v25.8H, v8.8H, v29.8H             // .........................................................................*. || ..........................................................*..
        // mls v25.8H, v20.8H, v7.H[0]           // ..........................................................................* || ............................................................*
        // trn1 v20.2D, v4.2D, v28.2D            // ......................................................................*.... || .....................................................*.......
        // sqrdmulh v0.8H, v24.8H, v18.8H        // ........................................................................*.. || ........................................................*....
        
        sub count, count, #1
layer4567_start:
        ldr x28, [x3], #16                       // ................e...........................................................................................................
        ins v31.d[1], x14                        // ...............................................................*............................................................
        ldr x14, [x4, #56]                       // .............................................................e..............................................................
        mul v11.8H, v24.8H, v29.8H               // ........................................................................*...................................................
        ldr x11, [x4], #(6*16)                   // ................................................e...........................................................................
        ldr x26, [x1, #64]                       // e...........................................................................................................................
        ldr x17, [x1, #112]                      // ............e...............................................................................................................
        sub v5.8H, v9.8H, v25.8H                 // ................................................................................*...........................................
        ldr x18, [x4, #-24]                      // .................................................................e..........................................................
        add v9.8H, v9.8H, v25.8H                 // .................................................................................*..........................................
        ldr x27, [x4, #-16]                      // ....................................................................e.......................................................
        // gap                                   // ............................................................................................................................
        mls v11.8H, v0.8H, v7.H[0]               // ..........................................................................*.................................................
        ins v6.d[0], x28                         // ..................e.........................................................................................................
        ldr x20, [x4, #-32]                      // ................................................................e...........................................................
        ins v29.d[0], x11                        // ..................................................e.........................................................................
        ldr x22, [x1, #96]                       // ........e...................................................................................................................
        // gap                                   // ............................................................................................................................
        ins v4.d[0], x17                         // ..............e.............................................................................................................
        ldr x8, [x3, #-8]                        // .................e..........................................................................................................
        sqrdmulh v25.8H, v5.8H, v19.8H           // ........................................................................................*...................................
        ins v19.d[0], x27                        // ......................................................................e.....................................................
        ldr x13, [x4, #-88]                      // .................................................e..........................................................................
        // gap                                   // ............................................................................................................................
        mul v24.8H, v5.8H, v30.8H                // .......................................................................................*....................................
        ins v30.d[0], x20                        // ..................................................................e.........................................................
        ldr x24, [x1, #120]                      // .............e..............................................................................................................
        ins v17.d[0], x22                        // ..........e.................................................................................................................
        ldr x17, [x4, #-80]                      // ....................................................e.......................................................................
        ldr x15, [x1, #104]                      // .........e..................................................................................................................
        ins v6.d[1], x8                          // ...................e........................................................................................................
        sqrdmulh v10.8H, v9.8H, v31.8H           // ...................................................................................*........................................
        ldr x29, [x1, #80]                       // ....e.......................................................................................................................
        ins v29.d[1], x13                        // ...................................................e........................................................................
        ldr x16, [x4, #-72]                      // .....................................................e......................................................................
        // gap                                   // ............................................................................................................................
        ins v4.d[1], x24                         // ...............e............................................................................................................
        ldr x23, [x4, #-8]                       // .....................................................................e......................................................
        mul v15.8H, v9.8H, v26.8H                // ..................................................................................*.........................................
        ins v18.d[0], x17                        // ......................................................e.....................................................................
        ldr x7, [x4, #-48]                       // ............................................................e...............................................................
        // gap                                   // ............................................................................................................................
        mls v24.8H, v25.8H, v7.H[0]              // .........................................................................................*..................................
        ins v5.d[0], x29                         // ......e.....................................................................................................................
        ldr x10, [x1, #88]                       // .....e......................................................................................................................
        sub v8.8H, v20.8H, v11.8H                // ...........................................................................*................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mls v15.8H, v10.8H, v7.H[0]              // ....................................................................................*.......................................
        ins v17.d[1], x15                        // ...........e................................................................................................................
        ldr x15, [x4, #-64]                      // ........................................................e...................................................................
        ins v30.d[1], x18                        // ...................................................................e........................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        sqrdmulh v12.8H, v4.8H, v6.H[1]          // ..........................e.................................................................................................
        add v27.8H, v20.8H, v11.8H               // ............................................................................*...............................................
        // gap                                   // ............................................................................................................................
        ins v18.d[1], x16                        // .......................................................e....................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mul v10.8H, v4.8H, v6.H[0]               // .........................e..................................................................................................
        ins v5.d[1], x10                         // .......e....................................................................................................................
        ldr x10, [x1, #72]                       // .e..........................................................................................................................
        sub v3.8H, v27.8H, v15.8H                // .....................................................................................*......................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        sqrdmulh v16.8H, v17.8H, v6.H[1]         // .....................e......................................................................................................
        add v4.8H, v27.8H, v15.8H                // ......................................................................................*.....................................
        // gap                                   // ............................................................................................................................
        sub v1.8H, v8.8H, v24.8H                 // ..........................................................................................*.................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        add v31.8H, v8.8H, v24.8H                // ...........................................................................................*................................
        mls v10.8H, v12.8H, v7.H[0]              // ...........................e................................................................................................
        // gap                                   // ............................................................................................................................
        trn2 v12.4S, v4.4S, v3.4S                // .............................................................................................*..............................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mul v28.8H, v17.8H, v6.H[0]              // ....................e.......................................................................................................
        ins v23.d[0], x26                        // ..e.........................................................................................................................
        // gap                                   // ............................................................................................................................
        trn1 v25.4S, v31.4S, v1.4S               // ..............................................................................................*.............................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        ins v19.d[1], x23                        // .......................................................................e....................................................
        sqdmulh v2.8H, v12.8H, v7.H[1]           // ...................................................................................................*........................
        // gap                                   // ............................................................................................................................
        add v17.8H, v5.8H, v10.8H                // .............................e..............................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        sub v9.8H, v5.8H, v10.8H                 // ............................e...............................................................................................
        mls v28.8H, v16.8H, v7.H[0]              // ......................e.....................................................................................................
        // gap                                   // ............................................................................................................................
        ins v26.d[0], x15                        // ..........................................................e.................................................................
        ldr x15, [x4, #-56]                      // .........................................................e..................................................................
        // gap                                   // ............................................................................................................................
        mul v0.8H, v17.8H, v6.H[2]               // ..............................e.............................................................................................
        ins v23.d[1], x10                        // ...e........................................................................................................................
        // gap                                   // ............................................................................................................................
        srshr v5.8H, v2.8H, #11                  // ....................................................................................................*.......................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        trn2 v13.4S, v31.4S, v1.4S               // ...............................................................................................*............................
        sqrdmulh v1.8H, v17.8H, v6.H[3]          // ...............................e............................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        trn1 v21.4S, v4.4S, v3.4S                // ............................................................................................*...............................
        sqrdmulh v22.8H, v9.8H, v6.H[5]          // ....................................e.......................................................................................
        // gap                                   // ............................................................................................................................
        ins v26.d[1], x15                        // ...........................................................e................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mul v2.8H, v9.8H, v6.H[4]                // ...................................e........................................................................................
        sub v8.8H, v23.8H, v28.8H                // .......................e....................................................................................................
        // gap                                   // ............................................................................................................................
        add v31.8H, v23.8H, v28.8H               // ........................e...................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mls v0.8H, v1.8H, v7.H[0]                // ................................e...........................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mls v2.8H, v22.8H, v7.H[0]               // .....................................e......................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        sqdmulh v9.8H, v21.8H, v7.H[1]           // ................................................................................................*...........................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        sub v24.8H, v31.8H, v0.8H                // .................................e..........................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        sqdmulh v11.8H, v25.8H, v7.H[1]          // ......................................................................................................*.....................
        add v16.8H, v31.8H, v0.8H                // ..................................e.........................................................................................
        // gap                                   // ............................................................................................................................
        sub v14.8H, v8.8H, v2.8H                 // ......................................e.....................................................................................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        add v31.8H, v8.8H, v2.8H                 // .......................................e....................................................................................
        sqdmulh v8.8H, v13.8H, v7.H[1]           // .........................................................................................................*..................
        // gap                                   // ............................................................................................................................
        srshr v27.8H, v9.8H, #11                 // .................................................................................................*..........................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mls v12.8H, v5.8H, v7.H[0]               // .....................................................................................................*......................
        trn2 v17.4S, v16.4S, v24.4S              // .........................................e..................................................................................
        // gap                                   // ............................................................................................................................
        srshr v20.8H, v11.8H, #11                // .......................................................................................................*....................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mls v21.8H, v27.8H, v7.H[0]              // ..................................................................................................*.........................
        trn2 v11.4S, v31.4S, v14.4S              // ...........................................e................................................................................
        // gap                                   // ............................................................................................................................
        srshr v10.8H, v8.8H, #11                 // ..........................................................................................................*.................
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        trn1 v4.4S, v16.4S, v24.4S               // ........................................e...................................................................................
        mls v25.8H, v20.8H, v7.H[0]              // ........................................................................................................*...................
        // gap                                   // ............................................................................................................................
        umov x19, v12.d[0]                       // ..............................................................................................................*.............
        umov x10, v12.d[1]                       // ...............................................................................................................*............
        trn2 v8.2D, v17.2D, v11.2D               // .............................................e..............................................................................
        mls v13.8H, v10.8H, v7.H[0]              // ...........................................................................................................*................
        trn1 v28.4S, v31.4S, v14.4S              // ..........................................e.................................................................................
        // gap                                   // ............................................................................................................................
        umov x25, v21.d[1]                       // .............................................................................................................*..............
        umov x12, v21.d[0]                       // ............................................................................................................*...............
        ins v31.d[0], x7                         // ..............................................................e.............................................................
        trn1 v9.2D, v17.2D, v11.2D               // ...............................................e............................................................................
        sqrdmulh v20.8H, v8.8H, v18.8H           // ..............................................................................e.............................................
        // gap                                   // ............................................................................................................................
        str x19, [x1, #16]                       // ......................................................................................................................*.....
        umov x7, v25.d[0]                        // ................................................................................................................*...........
        trn2 v24.2D, v4.2D, v28.2D               // ............................................e...............................................................................
        str x10, [x1, #48]                       // ..........................................................................................................................*.
        umov x16, v25.d[1]                       // .................................................................................................................*..........
        mul v25.8H, v8.8H, v29.8H                // .............................................................................e..............................................
        str x25, [x1, #32]                       // ........................................................................................................................*...
        umov x15, v13.d[1]                       // ...................................................................................................................*........
        umov x8, v13.d[0]                        // ..................................................................................................................*.........
        str x12, [x1], #( 16*4)                  // ....................................................................................................................*.......
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        mls v25.8H, v20.8H, v7.H[0]              // ...............................................................................e............................................
        trn1 v20.2D, v4.2D, v28.2D               // ..............................................e.............................................................................
        str x7, [x1, #-56]                       // .....................................................................................................................*......
        str x16, [x1, #-24]                      // .........................................................................................................................*..
        // gap                                   // ............................................................................................................................
        // gap                                   // ............................................................................................................................
        str x8, [x1, #-40]                       // .......................................................................................................................*....
        str x15, [x1, #-8]                       // ...........................................................................................................................*
        sqrdmulh v0.8H, v24.8H, v18.8H           // .........................................................................e..................................................
        
        // original source code
        // ldr x10, [x1, #(16*0)]                  // .....e......................................................................................................................|....e..................................................................................................................... || .e..................................................................................................................................
        // ldr x11, [x1, #((16*0)+8)]              // ..................................................e.........................................................................|.................................................e........................................................................ || ....................e...............................................................................................................
        // ins v8.d[0], x10                        // ...........................................................e................................................................|..........................................................e............................................................... || ..........................e.........................................................................................................
        // ins v8.d[1], x11                        // .....................................................................e......................................................|....................................................................e..................................................... || ................................e...................................................................................................
        // ldr x10, [x1, #(16*1)]                  // .............................e..............................................................................................|............................e............................................................................................. || ..........e.........................................................................................................................
        // ldr x11, [x1, #((16*1)+8)]              // .......................................e....................................................................................|......................................e................................................................................... || ..............e.....................................................................................................................
        // ins v9.d[0], x10                        // ......................................e.....................................................................................|.....................................e.................................................................................... || ..............e.....................................................................................................................
        // ins v9.d[1], x11                        // .................................................e..........................................................................|................................................e......................................................................... || ....................e...............................................................................................................
        // ldr x10, [x1, #(16*2)]                  // ...............e............................................................................................................|..............e........................................................................................................... || .....e..............................................................................................................................
        // ldr x11, [x1, #((16*2)+8)]              // ..........................e.................................................................................................|.........................e................................................................................................ || .........e..........................................................................................................................
        // ins v10.d[0], x10                       // ........................e...................................................................................................|.......................e.................................................................................................. || .........e..........................................................................................................................
        // ins v10.d[1], x11                       // ..........................................e.................................................................................|.........................................e................................................................................ || ................e...................................................................................................................
        // ldr x10, [x1, #(16*3)]                  // ......e.....................................................................................................................|.....e.................................................................................................................... || ..e.................................................................................................................................
        // ldr x11, [x1, #((16*3)+8)]              // .......................e....................................................................................................|......................e................................................................................................... || ........e...........................................................................................................................
        // ins v11.d[0], x10                       // ................e...........................................................................................................|...............e.......................................................................................................... || ......e.............................................................................................................................
        // ins v11.d[1], x11                       // ................................e...........................................................................................|...............................e.......................................................................................... || ............e.......................................................................................................................
        // ldr x10, [x3], #16                      // e...........................................................................................................................e.......................................................................................................................... || e...................................................................................................................................
        // ldr x11, [x3, #(-16+8)]                 // .................e..........................................................................................................|................e......................................................................................................... || ......e.............................................................................................................................
        // ins v0.d[0], x10                        // ............e...............................................................................................................|...........e.............................................................................................................. || ....e...............................................................................................................................
        // ins v0.d[1], x11                        // ...........................e................................................................................................|..........................e............................................................................................... || ..........e.........................................................................................................................
        // mul v24.8h, v10.8h, v0.h[0]             // ..........................................................e.................................................................|.........................................................e................................................................ || ..........................e.........................................................................................................
        // sqrdmulh v10.8h, v10.8h, v0.h[1]        // ....................................................e.......................................................................|...................................................e...................................................................... || ......................e.............................................................................................................
        // mls v24.8h, v10.8h, v7.h[0]             // .................................................................e..........................................................|................................................................e......................................................... || ..............................e.....................................................................................................
        // sub     v10.8h,    v8.8h, v24.8h        // .............................................................................e..............................................|............................................................................e............................................. || ......................................e.............................................................................................
        // add     v8.8h,    v8.8h, v24.8h         // ..............................................................................e.............................................|.............................................................................e............................................ || .......................................e............................................................................................
        // mul v24.8h, v11.8h, v0.h[0]             // ................................................e...........................................................................|...............................................e.......................................................................... || ....................e...............................................................................................................
        // sqrdmulh v11.8h, v11.8h, v0.h[1]        // .............................................e..............................................................................|............................................e............................................................................. || ..................e.................................................................................................................
        // mls v24.8h, v11.8h, v7.h[0]             // ........................................................e...................................................................|.......................................................e.................................................................. || ........................e...........................................................................................................
        // sub     v11.8h,    v9.8h, v24.8h        // ................................................................e...........................................................|...............................................................e.......................................................... || ..............................e.....................................................................................................
        // add     v9.8h,    v9.8h, v24.8h         // ...............................................................e............................................................|..............................................................e........................................................... || .............................e......................................................................................................
        // mul v24.8h, v9.8h, v0.h[2]              // ....................................................................e.......................................................|...................................................................e...................................................... || ................................e...................................................................................................
        // sqrdmulh v9.8h, v9.8h, v0.h[3]          // ........................................................................e...................................................|.......................................................................e.................................................. || ..................................e.................................................................................................
        // mls v24.8h, v9.8h, v7.h[0]              // ...............................................................................e............................................|..............................................................................e........................................... || ........................................e...........................................................................................
        // sub     v9.8h,    v8.8h, v24.8h         // ..................................................................................e.........................................|.................................................................................e........................................ || .............................................e......................................................................................
        // add     v8.8h,    v8.8h, v24.8h         // ....................................................................................e.......................................|...................................................................................e...................................... || ..............................................e.....................................................................................
        // mul v24.8h, v11.8h, v0.h[4]             // ............................................................................e...............................................|...........................................................................e.............................................. || ......................................e.............................................................................................
        // sqrdmulh v11.8h, v11.8h, v0.h[5]        // ..........................................................................e.................................................|.........................................................................e................................................ || ....................................e...............................................................................................
        // mls v24.8h, v11.8h, v7.h[0]             // ................................................................................e...........................................|...............................................................................e.......................................... || ..........................................e.........................................................................................
        // sub     v11.8h,    v10.8h, v24.8h       // .....................................................................................e......................................|....................................................................................e..................................... || ...............................................e....................................................................................
        // add     v10.8h,    v10.8h, v24.8h       // ......................................................................................e.....................................|.....................................................................................e.................................... || ................................................e...................................................................................
        // trn1 v25.4s, v8.4s, v9.4s               // ...............................................................................................e............................|..............................................................................................e........................... || ......................................................e.............................................................................
        // trn2 v26.4s, v8.4s, v9.4s               // ..........................................................................................e.................................|.........................................................................................e................................ || ..................................................e.................................................................................
        // trn1 v27.4s, v10.4s, v11.4s             // .....................................................................................................e......................|....................................................................................................e..................... || ........................................................e...........................................................................
        // trn2 v28.4s, v10.4s, v11.4s             // .............................................................................................e..............................|............................................................................................e............................. || ....................................................e...............................................................................
        // trn2 v10.2d, v25.2d, v27.2d             // .............................................................................................................e..............|............................................................................................................e............. || ...........................................................e........................................................................
        // trn2 v11.2d, v26.2d, v28.2d             // ...................................................................................................e........................|..................................................................................................e....................... || .......................................................e............................................................................
        // trn1 v8.2d, v25.2d, v27.2d              // ......................................................................................................................e.....|.....................................................................................................................e.... || ...............................................................e....................................................................
        // trn1 v9.2d, v26.2d, v28.2d              // .........................................................................................................e..................|........................................................................................................e................. || ..........................................................e.........................................................................
        // ldr x10, [x4], #(6*16)                  // ....e.......................................................................................................................|...e...................................................................................................................... || .e..................................................................................................................................
        // ldr x11, [x4, #(-(6*16)+8)]             // ....................e.......................................................................................................|...................e...................................................................................................... || .......e............................................................................................................................
        // ins v0.d[0], x10                        // ..............e.............................................................................................................|.............e............................................................................................................ || .....e..............................................................................................................................
        // ins v0.d[1], x11                        // ..............................e.............................................................................................|.............................e............................................................................................ || ...........e........................................................................................................................
        // ldr x10, [x4, #(-6*16 + 1*16)]          // .........................e..................................................................................................|........................e................................................................................................. || .........e..........................................................................................................................
        // ldr x11, [x4, #((-6*16 + 1*16)+8)]      // ...............................e............................................................................................|..............................e........................................................................................... || ...........e........................................................................................................................
        // ins v4.d[0], x10                        // ...................................e........................................................................................|..................................e....................................................................................... || .............e......................................................................................................................
        // ins v4.d[1], x11                        // ...............................................e............................................................................|..............................................e........................................................................... || ...................e................................................................................................................
        // ldr x10, [x4, #(-6*16 + 2*16)]          // ...........................................e................................................................................|..........................................e............................................................................... || ................e...................................................................................................................
        // ldr x11, [x4, #((-6*16 + 2*16)+8)]      // ...................................................................e........................................................|..................................................................e....................................................... || ...............................e....................................................................................................
        // ins v1.d[0], x10                        // ..................................................................e.........................................................|.................................................................e........................................................ || ...............................e....................................................................................................
        // ins v1.d[1], x11                        // ...........................................................................e................................................|..........................................................................e............................................... || .....................................e..............................................................................................
        // ldr x10, [x4, #(-6*16 + 3*16)]          // ....................................e.......................................................................................|...................................e...................................................................................... || .............e......................................................................................................................
        // ldr x11, [x4, #((-6*16 + 3*16)+8)]      // ..e.........................................................................................................................|.e........................................................................................................................ || e...................................................................................................................................
        // ins v5.d[0], x10                        // ........................................................................................................e...................|.......................................................................................................e.................. || .........................................................e..........................................................................
        // ins v5.d[1], x11                        // .*..........................................................................................................................|*......................................................................................................................... || ..................................................................*.................................................................
        // ldr x10, [x4, #(-6*16 + 4*16)]          // .............e..............................................................................................................|............e............................................................................................................. || ....e...............................................................................................................................
        // ldr x11, [x4, #((-6*16 + 4*16)+8)]      // ........e...................................................................................................................|.......e.................................................................................................................. || ..e.................................................................................................................................
        // ins v2.d[0], x10                        // ......................e.....................................................................................................|.....................e.................................................................................................... || ........e...........................................................................................................................
        // ins v2.d[1], x11                        // ............................................e...............................................................................|...........................................e.............................................................................. || .................e..................................................................................................................
        // ldr x10, [x4, #(-6*16 + 5*16)]          // ..........e.................................................................................................................|.........e................................................................................................................ || ...e................................................................................................................................
        // ldr x11, [x4, #((-6*16 + 5*16)+8)]      // .................................e..........................................................................................|................................e......................................................................................... || ............e.......................................................................................................................
        // ins v6.d[0], x10                        // ...................e........................................................................................................|..................e....................................................................................................... || .......e............................................................................................................................
        // ins v6.d[1], x11                        // .............................................................e..............................................................|............................................................e............................................................. || ............................e.......................................................................................................
        // mul        v24.8h,  v10.8h, v0.8h       // ...*........................................................................................................................|..*....................................................................................................................... || ...................................................................*................................................................
        // sqrdmulh v10.8h, v10.8h, v4.8h          // ...........................................................................................................................e|.......................................................................................................................... || .................................................................e..................................................................
        // mls v24.8h, v10.8h, v7.h[0]             // ...........*................................................................................................................|..........*............................................................................................................... || ......................................................................*.............................................................
        // sub    v10.8h,    v8.8h, v24.8h         // ........................................*...................................................................................|.......................................*.................................................................................. || .................................................................................*..................................................
        // add    v8.8h,    v8.8h, v24.8h          // ..............................................*.............................................................................|.............................................*............................................................................ || ....................................................................................*...............................................
        // mul        v24.8h,  v11.8h, v0.8h       // ................................................................................................................e...........|...............................................................................................................e.......... || ............................................................e.......................................................................
        // sqrdmulh v11.8h, v11.8h, v4.8h          // ..........................................................................................................e.................|.........................................................................................................e................ || ..........................................................e.........................................................................
        // mls v24.8h, v11.8h, v7.h[0]             // .....................................................................................................................e......|....................................................................................................................e..... || ...............................................................e....................................................................
        // sub    v11.8h,    v9.8h, v24.8h         // .......*....................................................................................................................|......*................................................................................................................... || ....................................................................*...............................................................
        // add    v9.8h,    v9.8h, v24.8h          // .........*..................................................................................................................|........*................................................................................................................. || .....................................................................*..............................................................
        // mul        v24.8h,  v9.8h, v1.8h        // ..................................*.........................................................................................|.................................*........................................................................................ || ..............................................................................*.....................................................
        // sqrdmulh v9.8h, v9.8h, v5.8h            // ............................*...............................................................................................|...........................*.............................................................................................. || ............................................................................*.......................................................
        // mls v24.8h, v9.8h, v7.h[0]              // .........................................*..................................................................................|........................................*................................................................................. || ..................................................................................*.................................................
        // sub    v9.8h,    v8.8h, v24.8h          // ...................................................*........................................................................|..................................................*....................................................................... || .......................................................................................*............................................
        // add    v8.8h,    v8.8h, v24.8h          // .....................................................*......................................................................|....................................................*..................................................................... || ........................................................................................*...........................................
        // mul        v24.8h,  v11.8h, v2.8h       // .....................*......................................................................................................|....................*..................................................................................................... || ..........................................................................*.........................................................
        // sqrdmulh v11.8h, v11.8h, v6.8h          // ..................*.........................................................................................................|.................*........................................................................................................ || ........................................................................*...........................................................
        // mls v24.8h, v11.8h, v7.h[0]             // .....................................*......................................................................................|....................................*..................................................................................... || ................................................................................*...................................................
        // sub    v11.8h,    v10.8h, v24.8h        // ......................................................*.....................................................................|.....................................................*.................................................................... || .........................................................................................*..........................................
        // add    v10.8h,    v10.8h, v24.8h        // .......................................................*....................................................................|......................................................*................................................................... || ..........................................................................................*.........................................
        // trn1 v25.4s, v8.4s, v9.4s               // .........................................................................*..................................................|........................................................................*................................................. || ......................................................................................................*.............................
        // trn2 v26.4s, v8.4s, v9.4s               // .........................................................*..................................................................|........................................................*................................................................. || ...........................................................................................*........................................
        // trn1 v27.4s, v10.4s, v11.4s             // ............................................................*...............................................................|...........................................................*.............................................................. || .............................................................................................*......................................
        // trn2 v28.4s, v10.4s, v11.4s             // .......................................................................*....................................................|......................................................................*................................................... || ....................................................................................................*...............................
        // sqdmulh v24.8h, v25.8h, v7.h[1]         // .................................................................................*..........................................|................................................................................*......................................... || ..............................................................................................................*.....................
        // srshr    v24.8h, v24.8h, #11            // ........................................................................................*...................................|.......................................................................................*.................................. || ...................................................................................................................*................
        // mls v25.8h, v24.8h, v7.h[0]             // ............................................................................................*...............................|...........................................................................................*.............................. || ......................................................................................................................*.............
        // sqdmulh v24.8h, v26.8h, v7.h[1]         // ..............................................................*.............................................................|.............................................................*............................................................ || ..............................................................................................*.....................................
        // srshr    v24.8h, v24.8h, #11            // ......................................................................*.....................................................|.....................................................................*.................................................... || ...................................................................................................*................................
        // mls v26.8h, v24.8h, v7.h[0]             // .........................................................................................*..................................|........................................................................................*................................. || ....................................................................................................................*...............
        // sqdmulh v24.8h, v27.8h, v7.h[1]         // ...................................................................................*........................................|..................................................................................*....................................... || ................................................................................................................*...................
        // srshr    v24.8h, v24.8h, #11            // ...........................................................................................*................................|..........................................................................................*............................... || .....................................................................................................................*..............
        // mls v27.8h, v24.8h, v7.h[0]             // ................................................................................................*...........................|...............................................................................................*.......................... || ........................................................................................................................*...........
        // sqdmulh v24.8h, v28.8h, v7.h[1]         // .......................................................................................*....................................|......................................................................................*................................... || ..................................................................................................................*.................
        // srshr    v24.8h, v24.8h, #11            // ..............................................................................................*.............................|.............................................................................................*............................ || .......................................................................................................................*............
        // mls v28.8h, v24.8h, v7.h[0]             // ....................................................................................................*.......................|...................................................................................................*...................... || ..........................................................................................................................*.........
        // umov x10, v25.d[0]                      // .......................................................................................................*....................|......................................................................................................*................... || ...........................................................................................................................*........
        // umov x11, v25.d[1]                      // ......................................................................................................*.....................|.....................................................................................................*.................... || ...........................................................................................................................*........
        // umov x12, v26.d[0]                      // .................................................................................................*..........................|................................................................................................*......................... || .........................................................................................................................*..........
        // umov x13, v26.d[1]                      // ..................................................................................................*.........................|.................................................................................................*........................ || .........................................................................................................................*..........
        // umov x14, v27.d[0]                      // ............................................................................................................*...............|...........................................................................................................*.............. || .............................................................................................................................*......
        // umov x15, v27.d[1]                      // ...............................................................................................................*............|..............................................................................................................*........... || ..............................................................................................................................*.....
        // umov x16, v28.d[0]                      // ...................................................................................................................*........|..................................................................................................................*....... || ...............................................................................................................................*....
        // umov x17, v28.d[1]                      // ..................................................................................................................*.........|.................................................................................................................*........ || ...............................................................................................................................*....
        // str x10, [x1], #( 16*4)                 // ....................................................................................................................*.......|...................................................................................................................*...... || ................................................................................................................................*...
        // str x14, [x1,  #(-16*4 + 8*1)]          // .......................................................................................................................*....|......................................................................................................................*... || .................................................................................................................................*..
        // str x12, [x1,  #(-16*4 + 8*2)]          // ...........................................................................................................*................|..........................................................................................................*............... || .............................................................................................................................*......
        // str x16, [x1,  #(-16*4 + 8*3)]          // .........................................................................................................................*..|........................................................................................................................*. || ...................................................................................................................................*
        // str x11, [x1,  #(-16*4 + 8*4)]          // .................................................................................................................*..........|................................................................................................................*......... || ...............................................................................................................................*....
        // str x15, [x1,  #(-16*4 + 8*5)]          // ........................................................................................................................*...|.......................................................................................................................*.. || ..................................................................................................................................*.
        // str x13, [x1,  #(-16*4 + 8*6)]          // ..............................................................................................................*.............|.............................................................................................................*............ || ..............................................................................................................................*.....
        // str x17, [x1,  #(-16*4 + 8*7)]          // ..........................................................................................................................*.|.........................................................................................................................* || ...................................................................................................................................*
        
        sub count, count, #1
        cbnz count, layer4567_start
        ins v31.d[1], x14                       // *................................................
        mul v21.8H, v24.8H, v29.8H              // .*...............................................
        // gap                                  // .................................................
        sub v1.8H, v9.8H, v25.8H                // ..*..............................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        add v14.8H, v9.8H, v25.8H               // ...*.............................................
        mls v21.8H, v0.8H, v7.H[0]              // ....*............................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sqrdmulh v16.8H, v1.8H, v19.8H          // .....*...........................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sqrdmulh v31.8H, v14.8H, v31.8H         // .......*.........................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sub v29.8H, v20.8H, v21.8H              // ..........*......................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        add v21.8H, v20.8H, v21.8H              // ............*....................................
        mul v1.8H, v1.8H, v30.8H                // ......*..........................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        mls v1.8H, v16.8H, v7.H[0]              // .........*.......................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        mul v14.8H, v14.8H, v26.8H              // ........*........................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        mls v14.8H, v31.8H, v7.H[0]             // ...........*.....................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sub v16.8H, v29.8H, v1.8H               // ...............*.................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        add v1.8H, v29.8H, v1.8H                // ................*................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sub v20.8H, v21.8H, v14.8H              // .............*...................................
        trn2 v31.4S, v1.4S, v16.4S              // .....................*...........................
        // gap                                  // .................................................
        add v21.8H, v21.8H, v14.8H              // ..............*..................................
        trn1 v1.4S, v1.4S, v16.4S               // ..................*..............................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sqdmulh v14.8H, v31.8H, v7.H[1]         // .........................*.......................
        // gap                                  // .................................................
        // gap                                  // .................................................
        trn2 v16.4S, v21.4S, v20.4S             // .................*...............................
        // gap                                  // .................................................
        // gap                                  // .................................................
        trn1 v21.4S, v21.4S, v20.4S             // ......................*..........................
        sqdmulh v20.8H, v1.8H, v7.H[1]          // ........................*........................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sqdmulh v29.8H, v16.8H, v7.H[1]         // ...................*.............................
        // gap                                  // .................................................
        // gap                                  // .................................................
        srshr v14.8H, v14.8H, #11               // ..............................*..................
        // gap                                  // .................................................
        // gap                                  // .................................................
        sqdmulh v10.8H, v21.8H, v7.H[1]         // .......................*.........................
        // gap                                  // .................................................
        // gap                                  // .................................................
        srshr v20.8H, v20.8H, #11               // ............................*....................
        // gap                                  // .................................................
        // gap                                  // .................................................
        mls v31.8H, v14.8H, v7.H[0]             // ..................................*..............
        // gap                                  // .................................................
        // gap                                  // .................................................
        srshr v14.8H, v29.8H, #11               // ....................*............................
        // gap                                  // .................................................
        // gap                                  // .................................................
        mls v1.8H, v20.8H, v7.H[0]              // ...............................*.................
        // gap                                  // .................................................
        // gap                                  // .................................................
        srshr v20.8H, v10.8H, #11               // ..........................*......................
        // gap                                  // .................................................
        // gap                                  // .................................................
        mls v16.8H, v14.8H, v7.H[0]             // ...........................*.....................
        // gap                                  // .................................................
        // gap                                  // .................................................
        umov x10, v31.d[0]                      // ...........................................*.....
        umov x20, v31.d[1]                      // ..........................................*......
        // gap                                  // .................................................
        mls v21.8H, v20.8H, v7.H[0]             // .............................*...................
        // gap                                  // .................................................
        // gap                                  // .................................................
        umov x29, v1.d[0]                       // ......................................*..........
        umov x18, v1.d[1]                       // ........................................*........
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        umov x22, v16.d[0]                      // ................................*................
        umov x17, v16.d[1]                      // .................................*...............
        str x10, [x1, #24]                      // ...............................................*.
        str x20, [x1, #56]                      // ................................................*
        // gap                                  // .................................................
        // gap                                  // .................................................
        umov x10, v21.d[1]                      // ...................................*.............
        umov x20, v21.d[0]                      // ....................................*............
        str x29, [x1, #8]                       // .............................................*...
        str x18, [x1, #40]                      // ..............................................*..
        // gap                                  // .................................................
        // gap                                  // .................................................
        str x22, [x1, #16]                      // .....................................*...........
        str x17, [x1, #48]                      // .......................................*.........
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        // gap                                  // .................................................
        str x10, [x1, #32]                      // .........................................*.......
        str x20, [x1], #( 16*4)                 // ............................................*....
        // gap                                  // .................................................
        
        // original source code
        // ins v31.d[1], x14                    // *................................................ || *.............................................
        // mul v11.8H, v24.8H, v29.8H           // .*............................................... || *.............................................
        // sub v5.8H, v9.8H, v25.8H             // ..*.............................................. || .*............................................
        // add v9.8H, v9.8H, v25.8H             // ...*............................................. || ..*...........................................
        // mls v11.8H, v0.8H, v7.H[0]           // ....*............................................ || ..*...........................................
        // sqrdmulh v25.8H, v5.8H, v19.8H       // .....*........................................... || ....*.........................................
        // mul v24.8H, v5.8H, v30.8H            // .........*....................................... || ........*.....................................
        // sqrdmulh v10.8H, v9.8H, v31.8H       // ......*.......................................... || ......*.......................................
        // mul v15.8H, v9.8H, v26.8H            // ...........*..................................... || ............*.................................
        // mls v24.8H, v25.8H, v7.H[0]          // ..........*...................................... || ..........*...................................
        // sub v8.8H, v20.8H, v11.8H            // .......*......................................... || .......*......................................
        // mls v15.8H, v10.8H, v7.H[0]          // ............*.................................... || ..............*...............................
        // add v27.8H, v20.8H, v11.8H           // ........*........................................ || ........*.....................................
        // sub v3.8H, v27.8H, v15.8H            // ...............*................................. || ...................*..........................
        // add v4.8H, v27.8H, v15.8H            // .................*............................... || ....................*.........................
        // sub v1.8H, v8.8H, v24.8H             // .............*................................... || ...............*..............................
        // add v31.8H, v8.8H, v24.8H            // ..............*.................................. || ................*.............................
        // trn2 v12.4S, v4.4S, v3.4S            // ....................*............................ || .......................*......................
        // trn1 v25.4S, v31.4S, v1.4S           // ..................*.............................. || ....................*.........................
        // sqdmulh v2.8H, v12.8H, v7.H[1]       // .......................*......................... || ..........................*...................
        // srshr v5.8H, v2.8H, #11              // ............................*.................... || ...............................*..............
        // trn2 v13.4S, v31.4S, v1.4S           // ................*................................ || ...................*..........................
        // trn1 v21.4S, v4.4S, v3.4S            // .....................*........................... || ........................*.....................
        // sqdmulh v9.8H, v21.8H, v7.H[1]       // .........................*....................... || ............................*.................
        // sqdmulh v11.8H, v25.8H, v7.H[1]      // ......................*.......................... || ........................*.....................
        // sqdmulh v8.8H, v13.8H, v7.H[1]       // ...................*............................. || ......................*.......................
        // srshr v27.8H, v9.8H, #11             // ..............................*.................. || .................................*............
        // mls v12.8H, v5.8H, v7.H[0]           // ...............................*................. || ..................................*...........
        // srshr v20.8H, v11.8H, #11            // ..........................*...................... || .............................*................
        // mls v21.8H, v27.8H, v7.H[0]          // ..................................*.............. || ....................................*.........
        // srshr v10.8H, v8.8H, #11             // ........................*........................ || ...........................*..................
        // mls v25.8H, v20.8H, v7.H[0]          // .............................*................... || ................................*.............
        // umov x19, v12.d[0]                   // .....................................*........... || .......................................*......
        // umov x10, v12.d[1]                   // ......................................*.......... || .......................................*......
        // mls v13.8H, v10.8H, v7.H[0]          // ...........................*..................... || ..............................*...............
        // umov x25, v21.d[1]                   // .........................................*....... || .........................................*....
        // umov x12, v21.d[0]                   // ..........................................*...... || .........................................*....
        // str x19, [x1, #16]                   // .............................................*... || ...........................................*..
        // umov x7, v25.d[0]                    // ...................................*............. || .....................................*........
        // str x10, [x1, #48]                   // ..............................................*.. || ...........................................*..
        // umov x16, v25.d[1]                   // ....................................*............ || .....................................*........
        // str x25, [x1, #32]                   // ...............................................*. || .............................................*
        // umov x15, v13.d[1]                   // .................................*............... || ...................................*..........
        // umov x8, v13.d[0]                    // ................................*................ || ...................................*..........
        // str x12, [x1], #( 16*4)              // ................................................* || .............................................*
        // str x7, [x1, #-56]                   // ...........................................*..... || .........................................*....
        // str x16, [x1, #-24]                  // ............................................*.... || ..........................................*...
        // str x8, [x1, #-40]                   // .......................................*......... || .......................................*......
        // str x15, [x1, #-8]                   // ........................................*........ || ........................................*.....
        

       pop_stack
       ret